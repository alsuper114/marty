!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Marty=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({"./index.js":[function(require,module,exports){"use strict";require("babel/register");require("es6-promise").polyfill();var _=require("underscore");var state=require("./lib/state");var create=require("./lib/create");var dispose=require("./lib/dispose");var classes=require("./lib/classes");var Container=require("./lib/container");var Diagnostics=require("./lib/diagnostics");var EventEmitter=require("events").EventEmitter;var renderToString=require("./lib/renderToString");function createInstance(){return _.extend({dispose:dispose,version:"0.8.12",Diagnostics:Diagnostics,container:new Container,__events:new EventEmitter,renderToString:renderToString,createInstance:createInstance},state,create,classes)}module.exports=createInstance()},{"./lib/classes":16,"./lib/container":18,"./lib/create":20,"./lib/diagnostics":22,"./lib/dispose":24,"./lib/renderToString":29,"./lib/state":30,"babel/register":58,"es6-promise":61,events:59,underscore:67}],1:[function(require,module,exports){"use strict";var constants=require("./index");module.exports=constants(["ACTION_STARTING","ACTION_DONE","ACTION_FAILED"])},{"./index":2}],2:[function(require,module,exports){"use strict";module.exports=require("../lib/constants")},{"../lib/constants":17}],3:[function(require,module,exports){"use strict";var constants=require("./index");module.exports=constants(["PENDING","FAILED","DONE"])},{"./index":2}],4:[function(require,module,exports){"use strict";module.exports=require("./lib/dispatcher")},{"./lib/dispatcher":23}],5:[function(require,module,exports){"use strict";function ActionHandlerNotFoundError(actionHandler,store){this.name="Action handler not found";this.message='The action handler "'+actionHandler+'" could not be found';if(store&&store.displayName){this.message+=" in the "+store.displayName+" store"}}ActionHandlerNotFoundError.prototype=Error.prototype;module.exports=ActionHandlerNotFoundError},{}],6:[function(require,module,exports){"use strict";function ActionPredicateUndefinedError(actionHandler,store){this.name="Action predicate undefined";this.message='The action predicate for "'+actionHandler+'" was undefined';if(store&&store.displayName){this.message+=" in the "+store.displayName+" store"}}ActionPredicateUndefinedError.prototype=Error.prototype;module.exports=ActionPredicateUndefinedError},{}],7:[function(require,module,exports){"use strict";function CompoundError(errors){this.errors=errors;this.name="Compound error"}CompoundError.prototype=Error.prototype;module.exports=CompoundError},{}],8:[function(require,module,exports){"use strict";function NotFoundError(message){this.name="Not found";this.message=message||"Not found";this.status=404}NotFoundError.prototype=Error.prototype;module.exports=NotFoundError},{}],9:[function(require,module,exports){"use strict";function UnkownStoreError(store){this.name="Unknown store";this.message="Unknown store "+store}UnkownStoreError.prototype=Error.prototype;module.exports=UnkownStoreError},{}],10:[function(require,module,exports){"use strict";var _=require("underscore");var CONTENT_TYPE="Content-Type";var JSON_CONTENT_TYPE="application/json";module.exports={after:function after(res){if(isJson(res)){return res.json().then(function(body){res.body=body;return res})}return res}};function isJson(res){var contentTypes=res.headers.get(CONTENT_TYPE);if(!_.isArray(contentTypes)){if(contentTypes===undefined||contentTypes===null){contentTypes=[]}else{contentTypes=[contentTypes]}}return _.any(contentTypes,function(contentType){return contentType.indexOf(JSON_CONTENT_TYPE)!==-1})}},{underscore:67}],11:[function(require,module,exports){"use strict";var _=require("underscore");var CONTENT_TYPE="Content-Type";var JSON_CONTENT_TYPE="application/json";module.exports={before:function before(req){var contentType=req.headers[CONTENT_TYPE]||JSON_CONTENT_TYPE;if(typeof FormData!=="undefined"&&req.body instanceof FormData){return}if(contentType===JSON_CONTENT_TYPE&&_.isObject(req.body)){req.body=JSON.stringify(req.body);req.headers[CONTENT_TYPE]=JSON_CONTENT_TYPE}}}},{underscore:67}],12:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var _=require("underscore");var log=require("../logger");var uuid=require("../utils/uuid");var Instances=require("../instances");var resolve=require("../utils/resolve");var ActionPayload=require("../actionPayload");var serializeError=require("../utils/serializeError");var ActionConstants=require("../../constants/actions");var FUNCTIONS_TO_NOT_WRAP=["constructor"];function getInstance(creators){return Instances.get(creators)}var ActionCreators=function(){function ActionCreators(options){_classCallCheck(this,ActionCreators);this.__type="ActionCreators";this.__id=uuid.type(this.__type);Instances.add(this,options);var props=_.difference(Object.getOwnPropertyNames(this.constructor.prototype),FUNCTIONS_TO_NOT_WRAP);_.each(props,function(name){var func=this[name];if(_.isFunction(func)){this[name]=wrapFunction(this,this[name],name)}},this)}_prototypeProperties(ActionCreators,null,{getActionType:{value:function getActionType(name){return name.replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toUpperCase()},writable:true,configurable:true},"for":{value:function _for(obj){return resolve(this,obj)},writable:true,configurable:true},context:{get:function get(){return getInstance(this).context},configurable:true}});return ActionCreators}();module.exports=ActionCreators;function wrapFunction(creators,func,name){var _metadata=metadata(func,name);var actionType=_metadata.actionType;var annotations=_metadata.annotations;return function(){var result;var handlers=[];var dispatchedAction;var actionId=uuid.small();var context=actionContext();dispatchStarting();try{result=func.apply(context,arguments);if(result){if(_.isFunction(result.then)){result.then(dispatchDone,dispatchFailed)}else{dispatchDone()}}else{dispatchDone()}return result}catch(e){logError(e);dispatchFailed(e);throw e}function actionContext(){return _.extend({dispatch:function(){function _getOuter(){return dispatch}return function dispatch(){dispatchedAction=_getOuter()({id:actionId,type:actionType,handlers:handlers,arguments:arguments},annotations);return dispatchedAction}}()},creators)}function dispatchStarting(){if(annotations.silent){return}dispatch({internal:true,type:actionType+"_STARTING",arguments:[{id:actionId}]},annotations);dispatch({internal:true,type:ActionConstants.ACTION_STARTING,arguments:[{id:actionId,type:actionType,handlers:handlers,annotations:annotations}]},annotations)}function dispatchDone(){if(annotations.silent){return}dispatch({internal:true,type:actionType+"_DONE",arguments:[{id:actionId,handlers:handlers}]},annotations);dispatch({internal:true,type:ActionConstants.ACTION_DONE,arguments:[{id:actionId,handlers:handlers}]},annotations)}function dispatchFailed(err){err=serializeError(err);dispatch({internal:true,type:actionType+"_FAILED",arguments:[{error:err,id:actionId,handlers:handlers}]},annotations);dispatch({internal:true,type:ActionConstants.ACTION_FAILED,arguments:[{error:err,id:actionId,handlers:handlers}]},annotations);if(dispatchedAction){dispatchedAction.rollback();dispatchedAction.error=err}}};function metadata(func,name){var actionType;var annotations={};if(func.annotations){if(!func.annotations.type){throw new Error("Unknown action type")}actionType=func.annotations.type;annotations=_.omit(func.annotations,"type")}else if(creators.types&&creators.types[name]){actionType=creators.types[name]}else{actionType=creators.getActionType(name)}return{actionType:actionType,annotations:annotations}}function dispatch(payload,annotations){var dispatcher=getInstance(creators).dispatcher;var action=new ActionPayload(_.extend({},annotations,payload));dispatcher.dispatch(action);return action}function logError(err){var error="An error occured when dispatching a '"+actionType+"' action in ";error+=(creators.displayName||creators.id||" ")+"#"+name;log.error(error,err)}}module.exports=ActionCreators},{"../../constants/actions":1,"../actionPayload":15,"../instances":26,"../logger":27,"../utils/resolve":49,"../utils/serializeError":50,"../utils/uuid":52,underscore:67}],13:[function(require,module,exports){"use strict";var _=require("underscore");var createClass=require("../createClass");var ActionCreators=require("./actionCreators");var RESERVED_KEYWORDS=["dispatch"];function createActionCreatorsClass(properties){_.extend.apply(_,[properties].concat(properties.mixins));_.each(RESERVED_KEYWORDS,function(keyword){if(properties[keyword]){throw new Error(keyword+" is a reserved keyword")}});return createClass(_.omit(properties,"mixins"),ActionCreators)}module.exports=createActionCreatorsClass},{"../createClass":21,"./actionCreators":12,underscore:67}],14:[function(require,module,exports){"use strict";module.exports=require("./actionCreators")},{"./actionCreators":12}],15:[function(require,module,exports){"use strict";var _=require("underscore");var uuid=require("./utils/uuid");var Diagnostics=require("./diagnostics");var StatusConstants=require("../constants/status");function ActionPayload(options){options||(options={});var rollbackHandlers=[];var status=StatusConstants.PENDING;var handlers=options.handlers||[];_.extend(this,options);this.id=options.id||uuid.small();this.type=actionType(options.type);this.arguments=_.toArray(options.arguments);this.error=null;this.toJSON=toJSON;this.toString=toString;this.rollback=rollback;this.internal=!!options.internal;this.addViewHandler=addViewHandler;this.addStoreHandler=addStoreHandler;this.addRollbackHandler=addRollbackHandler;this.timestamp=options.timestamp||new Date;Object.defineProperty(this,"handlers",{get:function get(){return handlers}});Object.defineProperty(this,"status",{get:function get(){return status}});Object.defineProperty(this,"pending",{get:function get(){return status===StatusConstants.PENDING}});Object.defineProperty(this,"failed",{get:function get(){return status===StatusConstants.FAILED}});Object.defineProperty(this,"done",{get:function get(){return status===StatusConstants.DONE}});function actionType(type){if(_.isFunction(type)){return type.toString()}return type}function toString(){return JSON.stringify(this.toJSON(),null,2)}function toJSON(){var json=_.pick(this,"id","type","error","source","creator","internal","handlers","arguments","timestamp");json.status=this.status.toString();return json}function rollback(){_.each(rollbackHandlers,function(rollback){rollback(this.error)},this)}function addViewHandler(name,view){var storeHandler=handlers[handlers.length-1];var viewHandler={name:name,error:null,id:uuid.small()};storeHandler.views.push(viewHandler);return{dispose:function dispose(){if(Diagnostics.devtoolsEnabled){var state=view.state;if(state){viewHandler.state=JSON.parse(JSON.stringify(state))}}},failed:function failed(err){viewHandler.error=err}}}function addStoreHandler(store,handlerName){var handler={views:[],error:null,type:"Store",id:uuid.small(),name:handlerName,store:store.displayName};handlers.push(handler);return{dispose:function dispose(){if(Diagnostics.devtoolsEnabled){var state=(store.serialize||store.getState)();if(state){handler.state=JSON.parse(JSON.stringify(state))}}},failed:function failed(err){handler.error=err}}}function addRollbackHandler(rollbackHandler,context){if(_.isFunction(rollbackHandler)){if(context){rollbackHandler=_.bind(rollbackHandler,context)}rollbackHandlers.push(rollbackHandler)}}}module.exports=ActionPayload},{"../constants/status":3,"./diagnostics":22,"./utils/uuid":52,underscore:67}],16:[function(require,module,exports){"use strict";module.exports={Store:require("./store"),StateSource:require("./stateSource"),ActionCreators:require("./actionCreators"),HttpStateSource:require("./stateSource/http"),JSONStorageStateSource:require("./stateSource/jsonStorage"),LocalStorageStateSource:require("./stateSource/localStorage"),SessionStorageStateSource:require("./stateSource/sessionStorage")}},{"./actionCreators":14,"./stateSource":33,"./stateSource/http":32,"./stateSource/jsonStorage":34,"./stateSource/localStorage":35,"./stateSource/sessionStorage":37,"./store":43}],17:[function(require,module,exports){"use strict";var _=require("underscore");function constants(obj){return toConstant(obj);function toConstant(obj){if(!obj){return{}}if(_.isArray(obj)){return arrayToConstants(obj)}if(_.isObject(obj)){return objectToConstants(obj)}}function objectToConstants(obj){return _.object(_.map(obj,valueToArray));function valueToArray(value,actionType){return[actionType,toConstant(value)]}}function arrayToConstants(array){return _.object(_.map(array,pair));function pair(actionType){return[actionType,createActionCreator(actionType)]}}function createActionCreator(actionType){var constantActionCreator=function constantActionCreator(actionCreator,annotations){if(!actionCreator){actionCreator=dispatchActionCreator}else if(!_.isFunction(actionCreator)){annotations=actionCreator;actionCreator=dispatchActionCreator}actionCreator.annotations=_.extend({},annotations,{type:actionType});return actionCreator;function dispatchActionCreator(){this.dispatch.apply(this,arguments)}};constantActionCreator.type=actionType;constantActionCreator.isActionCreator=true;constantActionCreator.toString=function(){return actionType};return constantActionCreator}}module.exports=constants},{underscore:67}],18:[function(require,module,exports){"use strict";var _=require("underscore");var log=require("./logger");var Store=require("./store");var Context=require("./context");var warnings=require("./warnings");var classId=require("./utils/classId");var Environment=require("./environment");var StateSource=require("./stateSource");var ActionCreators=require("./actionCreators");var FUNCTIONS_TO_NOT_WRAP=["fetch"];function Container(){this.types={};this.defaults={}}Container.prototype={dispose:function dispose(){this.types={}},createContext:function createContext(req){return new Context(this,req)},get:function get(type,clazz){return(this.types[type]||{})[clazz]},getAll:function getAll(type){return _.values(this.types[type]||{})},getDefault:function getDefault(type,id){return this.defaults[type][id]},getAllDefaults:function getAllDefaults(type){return _.values(this.defaults[type])},register:function register(clazz){var defaultInstance=new clazz;var type=classType(defaultInstance);if(!this.types[type]){this.types[type]={}}if(!this.defaults[type]){this.defaults[type]={}}var id=classId(clazz,type);if(!id){throw CannotRegisterClassError(clazz,type)}clazz.id=id;clazz.type=type;this.types[type][id]=clazz;if(Environment.isServer){_.each(_.functions(defaultInstance),wrapResolverFunctions,defaultInstance)}this.defaults[type][id]=defaultInstance;return defaultInstance},resolve:function resolve(type,id,options){var clazz=(this.types[type]||{})[id];if(!clazz){throw CannotFindTypeWithId(type,id)}return new clazz(options)}};function classType(obj){if(obj instanceof Store){return"Store"}if(obj instanceof ActionCreators){return"ActionCreators"}if(obj instanceof StateSource){return"StateSource"}throw new Error("Unknown type")}function wrapResolverFunctions(functionName){if(FUNCTIONS_TO_NOT_WRAP.indexOf(functionName)!==-1){return}var instance=this;var originalFunc=instance[functionName];instance[functionName]=function(){if(warnings.callingResolverOnServer&&Environment.isServer){var type=instance.__type;var displayName=instance.displayName||instance.id;var warningMessage="Warning: You are calling `"+functionName+"` on the static instance of the "+type+" '"+displayName+"'. You should resolve the instance for the current context";log.warn(warningMessage)}return originalFunc.apply(instance,arguments)}}addTypeHelpers("Store");addTypeHelpers("StateSource");addTypeHelpers("ActionCreators");module.exports=Container;function addTypeHelpers(type){var proto=Container.prototype;var pluralType=type;if(pluralType[pluralType.length-1]!=="s"){pluralType+="s"}proto["get"+type]=_.partial(proto.get,type);proto["resolve"+type]=_.partial(proto.resolve,type);proto["getAll"+pluralType]=_.partial(proto.getAll,type);proto["getDefault"+type]=_.partial(proto.getDefault,type);proto["getAllDefault"+pluralType]=_.partial(proto.getAllDefaults,type)}function CannotFindTypeWithId(type,id){return new Error("Could not find "+type+" with Id "+id)}function CannotRegisterClassError(clazz,type){var message="Cannot register ";if(clazz&&clazz.displayName){message+=clazz.displayName+" "}return new Error(message+type+" because it does not have an Id.")}},{"./actionCreators":14,"./context":19,"./environment":25,"./logger":27,"./stateSource":33,"./store":43,"./utils/classId":47,"./warnings":53,underscore:67}],19:[function(require,module,exports){"use strict";var currentContext=null;var _=require("underscore");var uuid=require("./utils/uuid");var Dispatcher=require("./dispatcher");function Context(container,req){var fetchCount,deferredFetchFinished;this.req=req;this.instances={};this.id=uuid.generate();this.fetchStarted=fetchStarted;this.fetchFinished=fetchFinished;this.dispatcher=new Dispatcher;this.renderInContext=renderInContext;if(container){_.each(container.types,createInstancesOfType,this)}function renderInContext(cb,context){var fetchFinished,result;if(currentContext){throw new Error("Another context is in use")}fetchCount=0;deferredFetchFinished=deferred();fetchFinished=deferredFetchFinished.promise;try{currentContext=this;result=cb.call(context);fetchFinished=fetchFinished.then(function(){return result})}finally{currentContext=null}return fetchFinished}function fetchStarted(){fetchCount++}function fetchFinished(){fetchCount--;if(fetchCount===0){deferredFetchFinished.resolve()}}function createInstancesOfType(classes,type){var options={context:this,dispatcher:this.dispatcher};this.instances[type]={};_.each(classes,function(clazz){this.instances[type][clazz.id]=container.resolve(type,clazz.id,options)},this)}}function deferred(){var result={};result.promise=new Promise(function(resolve,reject){result.resolve=resolve;result.reject=reject});return result}Context.getCurrent=function(){return currentContext};Context.prototype={dispose:function dispose(){this.instances=null;this.dispatcher=null},resolve:function resolve(obj){if(!obj.constructor){throw new Error("Cannot resolve object")}var id=obj.constructor.id;var type=obj.constructor.type;if(!this.instances[type]){throw new Error("Context does not have any instances of "+type)}if(!this.instances[type][id]){throw new Error("Context does not have an instance of the "+type+" "+id)}return this.instances[type][id]},getAll:function getAll(type){return _.values(this.instances[type])}};addTypeHelpers("Store");addTypeHelpers("StateSource");addTypeHelpers("ActionCreators");module.exports=Context;function addTypeHelpers(type){var proto=Context.prototype;var pluralType=type;if(pluralType[pluralType.length-1]!=="s"){pluralType+="s"}proto["getAll"+pluralType]=_.partial(proto.getAll,type)}},{"./dispatcher":23,"./utils/uuid":52,underscore:67}],20:[function(require,module,exports){"use strict";var _=require("underscore");var warnings=require("./warnings");var constants=require("./constants");var STORE_CHANGED_EVENT="store-changed";var StateMixin=require("./mixins/stateMixin");var createStoreClass=require("./store/createStoreClass");var createStateSourceClass=require("./stateSource/createStateSourceClass");var createActionCreatorsClass=require("./actionCreators/createActionCreatorsClass");var DEFAULT_CLASS_NAME="Class";module.exports={register:register,createStore:createStore,createContext:createContext,createConstants:createConstants,createStateMixin:createStateMixin,createStateSource:createStateSource,createActionCreators:createActionCreators,addStoreChangeListener:addStoreChangeListener};function register(id,clazz){if(!_.isString(id)){clazz=id;id=null}var className=getClassName(clazz);if(!clazz.id){clazz.id=id||className}if(!clazz.displayName){clazz.displayName=clazz.id}return this.container.register(clazz)}function addStoreChangeListener(callback,context){var events=this.__events;if(context){callback=_.bind(callback,context)}events.on(STORE_CHANGED_EVENT,callback);return{dispose:_.bind(function(){events.removeListener(STORE_CHANGED_EVENT,callback)},this)}}function createContext(req){return this.container.createContext(req)}function createStore(properties){var StoreClass=createStoreClass(properties);var defaultInstance=this.register(StoreClass);warnings.without("callingResolverOnServer",function(){defaultInstance.addChangeListener(_.bind(onStoreChanged,this))},this);return defaultInstance}function getClassName(clazz){var funcNameRegex=/function (.{1,})\(/;var results=funcNameRegex.exec(clazz.toString());var className=results&&results.length>1?results[1]:"";return className===DEFAULT_CLASS_NAME?null:className}function onStoreChanged(){var events=this.__events;var args=_.toArray(arguments);args.unshift(STORE_CHANGED_EVENT);events.emit.apply(events,args)}function createConstants(obj){return constants(obj)}function createStateMixin(options){return new StateMixin(options)}function createActionCreators(properties){var ActionCreatorsClass=createActionCreatorsClass(properties);var defaultInstance=this.register(ActionCreatorsClass);return defaultInstance}function createStateSource(properties){var StateSourceClass=createStateSourceClass(properties);var defaultInstance=this.register(StateSourceClass);return defaultInstance}},{"./actionCreators/createActionCreatorsClass":13,"./constants":17,"./mixins/stateMixin":28,"./stateSource/createStateSourceClass":31,"./store/createStoreClass":39,"./warnings":53,underscore:67}],21:[function(require,module,exports){"use strict";var _=require("underscore");function createClass(properties,BaseType){function Class(options){classCallCheck(this,Class);this.id=properties.id;this.displayName=properties.displayName;var base=get(Object.getPrototypeOf(Class.prototype),"constructor",this);var baseOptions=_.extend({},options,properties);base.call(this,baseOptions)}if(BaseType){inherits(Class,BaseType)}_.extend(Class.prototype,properties);Class.id=properties.id;Class.displayName=properties.displayName;return Class}function get(_x,_x2,_x3){var _again=true;_function:while(_again){_again=false;var object=_x,property=_x2,receiver=_x3;desc=parent=getter=undefined;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{_x=parent;_x2=property;_x3=receiver;_again=true;continue _function}}else if("value"in desc&&desc.writable){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}}function inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){subClass.__proto__=superClass}}function classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}module.exports=createClass},{underscore:67}],22:[function(require,module,exports){"use strict";var diagnostics={trace:trace,enabled:false,devtoolsEnabled:false};module.exports=diagnostics;function trace(){if(diagnostics.enabled){console&&console.log.apply(console,arguments)}}},{}],23:[function(require,module,exports){"use strict";var uuid=require("./utils/uuid");var Dispatcher=require("flux").Dispatcher;var defaultDispatcher=createDefaultDispatcher();createDispatcher.getDefault=function(){return defaultDispatcher};createDispatcher.dispose=function(){defaultDispatcher=createDefaultDispatcher()};module.exports=createDispatcher;function createDefaultDispatcher(){var defaultDispatcher=createDispatcher();defaultDispatcher.isDefault=true;return defaultDispatcher}function createDispatcher(){var dispatcher=new Dispatcher;dispatcher.id=uuid.generate();dispatcher.isDefault=false;return dispatcher}},{"./utils/uuid":52,flux:62}],24:[function(require,module,exports){"use strict";var Dispatcher=require("./dispatcher");function dispose(){Dispatcher.dispose();this.container.dispose()}module.exports=dispose},{"./dispatcher":23}],25:[function(require,module,exports){"use strict";var windowDefined=typeof window!=="undefined";var environment=windowDefined?"browser":"server";module.exports={environment:environment,isServer:environment==="server",isBrowser:environment==="browser"}},{}],26:[function(require,module,exports){"use strict";var instances={};var _=require("underscore");var Dispatcher=require("../dispatcher");var Instances={get:function get(obj){return instances[this.getId(obj)]},getId:function getId(obj){var id=obj.__id;if(!id){throw new Error("Object does not have an Id")}return id},add:function add(obj,instance){instance=instance||{};var id=this.getId(obj);if(instances[id]){throw new Error("There is already an instance for the "+instance.__type+" "+id)}_.defaults(instance,{dispatcher:Dispatcher.getDefault()});instances[id]=instance;return instance},dispose:function dispose(obj){delete instances[this.getId(obj)]}};module.exports=Instances},{"../dispatcher":4,underscore:67}],27:[function(require,module,exports){"use strict";var _=require("underscore");if(console){module.exports=console}else{module.exports={log:_.noop,warn:_.noop,error:_.noop}}},{underscore:67}],28:[function(require,module,exports){"use strict";var _=require("underscore");var log=require("../logger");var Context=require("../context");var uuid=require("../utils/uuid");var Diagnostics=require("../diagnostics");var reservedKeys=["listenTo","getState","getInitialState"];function StateMixin(options){var config,instanceMethods;if(!options){throw new Error("The state mixin is expecting some options")}if(isStore(options)){config=storeMixinConfig(options)}else{config=simpleMixinConfig(options);instanceMethods=_.omit(options,reservedKeys)}var mixin=_.extend({onStoreChanged:function onStoreChanged(state,store){Diagnostics.trace(store.displayName,"store has changed. The",this.displayName,"component ("+this._marty.id+") is updating");if(this._lifeCycleState==="UNMOUNTED"){log.warn("Warning: Trying to set the state of ",this.displayName,"component ("+this._marty.id+") which is unmounted")}else{this.setState(this.tryGetState(store))}},tryGetState:function tryGetState(store){var handler;if(store&&store.action){handler=store.action.addViewHandler(this.displayName,this)}try{return this.getState()}catch(e){var errorMessage="An error occured while trying to get the latest state in the view "+this.displayName;log.error(errorMessage,e,this);if(handler){handler.failed(e)}return{}}finally{if(handler){handler.dispose()}}},componentDidMount:function componentDidMount(){Diagnostics.trace("The",this.displayName,"component ("+this._marty.id+") has mounted.");var context=Context.getCurrent();this._marty.listeners=_.map(config.stores,function(store){store=store["for"](context);Diagnostics.trace("The",this.displayName,"component  ("+this._marty.id+") is listening to the",store.displayName,"store");return store.addChangeListener(this.onStoreChanged)},this)},componentWillReceiveProps:function componentWillReceiveProps(nextProps){var oldProps=this.props;this.props=nextProps;var newState=this.getState();this.props=oldProps;this.setState(newState)},componentWillUnmount:function componentWillUnmount(){Diagnostics.trace("The",this.displayName,"component ("+this._marty.id+") is unmounting.","It is listening to",this._marty.listeners.length,"stores");_.each(this._marty.listeners,function(listener){listener.dispose()});this._marty.listeners=[]},getState:function getState(){return config.getState(this)},getInitialState:function getInitialState(){var el=this._currentElement;if(!this.displayName&&el&&el.type){this.displayName=el.type.displayName}this.state={};this._marty={listeners:[],id:uuid.small()};if(options.getInitialState){this.state=options.getInitialState()}this.state=_.extend(this.state,this.getState());return this.state}},instanceMethods);return mixin;function storeMixinConfig(store){store=store["for"](Context.getCurrent());return{stores:[store],getState:function getState(){return store.getState()}}}function simpleMixinConfig(options){var stores=options.listenTo||[];var storesToGetStateFrom=findStoresToGetStateFrom(options);if(!_.isArray(stores)){stores=[stores]}if(!areStores(stores)){throw new Error("Can only listen to stores")}stores=stores.concat(_.values(storesToGetStateFrom));return{stores:stores,getState:getState};function getState(view){var context=Context.getCurrent();var state=_.object(_.map(storesToGetStateFrom,getStateFromStore));if(options.getState){try{view.__context=context;state=_.extend(state,options.getState.call(view))}finally{view.__context=null}}return state;function getStateFromStore(store,name){var storeForContext=store["for"](context);return[name,storeForContext.getState()]}}function findStoresToGetStateFrom(options){var storesToGetStateFrom={};_.each(options,function(value,key){if(reservedKeys.indexOf(key)===-1&&isStore(value)){storesToGetStateFrom[key]=value}});return storesToGetStateFrom}}function areStores(stores){for(var i=stores.length-1;i>=0;i--){if(!isStore(stores[i])){return false}}return true}function isStore(store){return store.getState&&store.addChangeListener}}module.exports=StateMixin},{"../context":19,"../diagnostics":22,"../logger":27,"../utils/uuid":52,underscore:67}],29:[function(require,module,exports){"use strict";var React=require("react");var _=require("underscore");var Context=require("./context");var timeout=require("./utils/timeout");var DEFAULT_TIMEOUT=1e3;function renderToString(createElement,context,options){var Marty=this;options=_.defaults(options||{},{timeout:DEFAULT_TIMEOUT});return new Promise(function(resolve,reject){if(!_.isFunction(createElement)){throw new Error("createElement must be a function")}if(!context){reject(new Error("must pass in a context"));return}if(!context instanceof Context){reject(new Error("context must be an instance of Context"));return}var fetchData=Promise.race([renderToStringInContext(),timeout(options.timeout)]);fetchData.then(function(){context.renderInContext(function(){try{var element=createElement();if(!element){reject(new Error("createElement must return an element"));return}var html=React.renderToString(element);html+=serializedState(context);resolve(html)}catch(e){reject(e)}})});function renderToStringInContext(){return context.renderInContext(function(){try{var element=createElement();if(!element){reject(new Error("createElement must return an element"));return}React.renderToString(element)}catch(e){reject(e)}})}function serializedState(context){var state=Marty.serializeState(context);return'<script id="__marty-state">'+state+"</script>"}})}module.exports=renderToString},{"./context":19,"./utils/timeout":51,react:undefined,underscore:67}],30:[function(require,module,exports){"use strict";
var _=require("underscore");var UnknownStoreError=require("../errors/unknownStore");var SERIALIZED_WINDOW_OBJECT="__marty";module.exports={clearState:clearState,rehydrateState:rehydrateState,serializeState:serializeState,setInitialState:setInitialState};function getDefaultStores(context){return context.container.getAllDefaultStores()}function rehydrateState(){if(!window||!window[SERIALIZED_WINDOW_OBJECT]){return}var serializeState=window[SERIALIZED_WINDOW_OBJECT].state;if(serializeState){this.setInitialState(serializeState)}}function clearState(){_.each(getDefaultStores(this),function(store){store.clear()})}function setInitialState(states){var stores=indexById(getDefaultStores(this));_.each(states,function(state,storeName){var store=stores[storeName];if(!store){throw new UnknownStoreError(storeName)}store.setInitialState(state)});function indexById(stores){return _.object(_.map(stores,function(store){return storeId(store)}),stores)}}function serializeState(context){var state={};var stores=context?context.getAllStores():getDefaultStores(this);_.each(stores,function(store){var id=storeId(store);if(id){state[id]=(store.serialize||store.getState).call(store)}});state.toString=function(){return"(window.__marty||(window.__marty={})).state="+JSON.stringify(state)};state.toJSON=function(){return _.omit(state,"toString","toJSON")};return state}function storeId(store){return store.id||store.displayName}},{"../errors/unknownStore":9,underscore:67}],31:[function(require,module,exports){"use strict";var _=require("underscore");var HttpStateSource=require("./http");var StateSource=require("./stateSource");var createClass=require("../createClass");var JSONStorageStateSource=require("./jsonStorage");var LocalStorageStateSource=require("./localStorage");var SessionStorageStateSource=require("./sessionStorage");function createStateSourceClass(properties){properties=properties||{};var merge=[{},properties].concat(properties.mixins||[]);properties=_.extend.apply(_,merge);return createClass(properties,baseType(properties.type))}function baseType(type){switch(type){case"http":return HttpStateSource;case"jsonStorage":return JSONStorageStateSource;case"localStorage":return LocalStorageStateSource;case"sessionStorage":return SessionStorageStateSource;default:return StateSource}}module.exports=createStateSourceClass},{"../createClass":21,"./http":32,"./jsonStorage":34,"./localStorage":35,"./sessionStorage":37,"./stateSource":38,underscore:67}],32:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)subClass.__proto__=superClass};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};require("isomorphic-fetch");var hooks=[];var _=require("underscore");var log=require("../logger");var StateSource=require("./stateSource");var HttpStateSource=function(StateSource){function HttpStateSource(){_classCallCheck(this,HttpStateSource);this._isHttpStateSource=true}_inherits(HttpStateSource,StateSource);_prototypeProperties(HttpStateSource,null,{request:{value:function request(req){var _this=this;if(!req.headers){req.headers={}}beforeRequest(this,req);return fetch(req.url,req).then(function(res){return afterRequest(_this,res)})},writable:true,configurable:true},get:{value:function get(options){return this.request(requestOptions("GET",this,options))},writable:true,configurable:true},put:{value:function put(options){return this.request(requestOptions("PUT",this,options))},writable:true,configurable:true},post:{value:function post(options){return this.request(requestOptions("POST",this,options))},writable:true,configurable:true},"delete":{value:function _delete(options){return this.request(requestOptions("DELETE",this,options))},writable:true,configurable:true},patch:{value:function patch(options){return this.request(requestOptions("PATCH",this,options))},writable:true,configurable:true}});return HttpStateSource}(StateSource);HttpStateSource.addHook=addHook;HttpStateSource.defaultBaseUrl="";HttpStateSource.removeHook=removeHook;HttpStateSource.addHook(require("../../http/hooks/parseJSON"));HttpStateSource.addHook(require("../../http/hooks/stringifyJSON"));module.exports=HttpStateSource;function requestOptions(method,source,options){var baseUrl=source.baseUrl||HttpStateSource.defaultBaseUrl;if(_.isString(options)){options=_.extend({url:options})}options.method=method.toLowerCase();if(baseUrl){var separator="";var firstCharOfUrl=options.url[0];var lastCharOfBaseUrl=baseUrl[baseUrl.length-1];if(lastCharOfBaseUrl!=="/"&&firstCharOfUrl!=="/"){separator="/"}else if(lastCharOfBaseUrl==="/"&&firstCharOfUrl==="/"){options.url=options.url.substring(1)}options.url=baseUrl+separator+options.url}return options}function beforeRequest(source,req){_.each(getHooks("before"),function(hook){try{hook.before.call(source,req)}catch(e){log.error("Failed to execute hook before http request",e,hook);throw e}})}function afterRequest(source,res){var current;_.each(getHooks("after"),function(hook){var execute=function execute(res){try{return hook.after.call(source,res)}catch(e){log.error("Failed to execute hook after http response",e,hook);throw e}};if(current){current=current.then(function(res){return execute(res)})}else{current=execute(res);if(current&&!_.isFunction(current.then)){current=Promise.resolve(current)}}});return current||res}function getHooks(func){return _.chain(hooks).filter(has(func)).sortBy(priority).value();function priority(hook){return hook.priority}function has(func){return function(hook){return hook&&_.isFunction(hook[func])}}}function addHook(hook){if(hook){hooks.push(hook)}}function removeHook(hook){hooks=_.without(hooks,hook)}},{"../../http/hooks/parseJSON":10,"../../http/hooks/stringifyJSON":11,"../logger":27,"./stateSource":38,"isomorphic-fetch":66,underscore:67}],33:[function(require,module,exports){"use strict";module.exports=require("./stateSource")},{"./stateSource":38}],34:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)subClass.__proto__=superClass};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var StateSource=require("./stateSource");var noopStorage=require("./noopStorage");var JSONStorageStateSource=function(StateSource){function JSONStorageStateSource(){_classCallCheck(this,JSONStorageStateSource);this._isJSONStorageStateSource=true;if(!this.storage){this.storage=JSONStorageStateSource.defaultStorage}}_inherits(JSONStorageStateSource,StateSource);_prototypeProperties(JSONStorageStateSource,null,{get:{value:function get(key){var raw=getStorage(this).getItem(getNamespacedKey(this,key));if(!raw){return raw}try{var payload=JSON.parse(raw);return payload.value}catch(e){throw new Error("Unable to parse JSON from storage")}},writable:true,configurable:true},set:{value:function set(key,value){var payload={value:value};var raw=JSON.stringify(payload);getStorage(this).setItem(getNamespacedKey(this,key),raw)},writable:true,configurable:true}});return JSONStorageStateSource}(StateSource);function getNamespacedKey(source,key){return getNamespace(source)+key}function getNamespace(source){return source.namespace||JSONStorageStateSource.defaultNamespace}function getStorage(source){return source.storage||JSONStorageStateSource.defaultStorage||noopStorage}JSONStorageStateSource.defaultNamespace="";JSONStorageStateSource.defaultStorage=typeof window==="undefined"?noopStorage:window.localStorage;module.exports=JSONStorageStateSource},{"./noopStorage":36,"./stateSource":38}],35:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)subClass.__proto__=superClass};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var StateSource=require("./stateSource");var noopStorage=require("./noopStorage");var LocalStorageStateSource=function(StateSource){function LocalStorageStateSource(){_classCallCheck(this,LocalStorageStateSource);this._isLocalStorageStateSource=true;this.storage=typeof window==="undefined"?noopStorage:window.localStorage}_inherits(LocalStorageStateSource,StateSource);_prototypeProperties(LocalStorageStateSource,null,{get:{value:function get(key){return this.storage.getItem(getNamespacedKey(this,key))},writable:true,configurable:true},set:{value:function set(key,value){return this.storage.setItem(getNamespacedKey(this,key),value)},writable:true,configurable:true}});return LocalStorageStateSource}(StateSource);function getNamespacedKey(source,key){return getNamespace(source)+key}function getNamespace(source){return source.namespace||LocalStorageStateSource.defaultNamespace}LocalStorageStateSource.defaultNamespace="";module.exports=LocalStorageStateSource},{"./noopStorage":36,"./stateSource":38}],36:[function(require,module,exports){"use strict";var _=require("underscore");module.exports={getItem:_.noop,setItem:_.noop}},{underscore:67}],37:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)subClass.__proto__=superClass};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var StateSource=require("./stateSource");var noopStorage=require("./noopStorage");var SessionStorageStateSource=function(StateSource){function SessionStorageStateSource(){_classCallCheck(this,SessionStorageStateSource);this._isSessionStorageStateSource=true;this.storage=typeof window==="undefined"?noopStorage:window.sessionStorage}_inherits(SessionStorageStateSource,StateSource);_prototypeProperties(SessionStorageStateSource,null,{get:{value:function get(key){return this.storage.getItem(getNamespacedKey(this,key))},writable:true,configurable:true},set:{value:function set(key,value){return this.storage.setItem(getNamespacedKey(this,key),value)},writable:true,configurable:true}});return SessionStorageStateSource}(StateSource);function getNamespacedKey(source,key){return getNamespace(source)+key}function getNamespace(source){return source.namespace||SessionStorageStateSource.defaultNamespace}SessionStorageStateSource.defaultNamespace="";module.exports=SessionStorageStateSource},{"./noopStorage":36,"./stateSource":38}],38:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var uuid=require("../utils/uuid");var Instances=require("../instances");var resolve=require("../utils/resolve");var StateSource=function(){function StateSource(options){_classCallCheck(this,StateSource);this.__type="StateSource";this.__id=uuid.type(this.__type);Instances.add(this,options)}_prototypeProperties(StateSource,null,{context:{get:function get(){return Instances.get(this).context},configurable:true},"for":{value:function _for(obj){return resolve(this,obj)},writable:true,configurable:true}});return StateSource}();module.exports=StateSource},{"../instances":26,"../utils/resolve":49,"../utils/uuid":52}],39:[function(require,module,exports){"use strict";var _=require("underscore");var log=require("../logger");var Store=require("./store");var warnings=require("../warnings");var createClass=require("../createClass");var RESERVED_FUNCTIONS=["getState"];var REQUIRED_FUNCTIONS=["getInitialState"];var VIRTUAL_FUNCTIONS=["clear","dispose"];function createStoreClass(properties){validateStoreOptions(properties);addMixins(properties);var overrideFunctions=getOverrideFunctions(properties);var functionsToOmit=_.union(VIRTUAL_FUNCTIONS,RESERVED_FUNCTIONS);var classProperties=_.extend(_.omit(properties,functionsToOmit),overrideFunctions);return createClass(classProperties,Store)}function getOverrideFunctions(properties){var overrideFunctions=_.pick(properties,VIRTUAL_FUNCTIONS);_.each(_.functions(overrideFunctions),function(name){var override=overrideFunctions[name];overrideFunctions[name]=function(){Store.prototype[name].call(this);override.call(this)}});return overrideFunctions}function addMixins(properties){var handlers=_.map(properties.mixins,function(mixin){return mixin.handlers});var mixins=_.map(properties.mixins,function(mixin){return _.omit(mixin,"handlers")});_.extend.apply(_,[properties].concat(mixins));_.extend.apply(_,[properties.handlers].concat(handlers))}function validateStoreOptions(properties){var missingFunctions=[];var displayName=properties.displayName;_.each(RESERVED_FUNCTIONS,function(functionName){if(properties[functionName]){if(displayName){functionName+=" in "+displayName}if(warnings.reservedFunction){log.warn("Warning:",functionName,"is reserved for use by Marty. Please use a different name")}}});_.each(REQUIRED_FUNCTIONS,function(functionName){if(!properties[functionName]){missingFunctions.push(functionName)}});if(missingFunctions.length){var error="You must implement "+missingFunctions.join(",");if(displayName){error+=" in "+displayName}throw new Error(error)}}module.exports=createStoreClass},{"../createClass":21,"../logger":27,"../warnings":53,"./store":44,underscore:67}],40:[function(require,module,exports){"use strict";var _=require("underscore");var log=require("../logger");var warnings=require("../warnings");var Instances=require("../instances");var fetchResult=require("./fetchResult");var CompoundError=require("../../errors/compound");var NotFoundError=require("../../errors/notFound");var StatusConstants=require("../../constants/status");function fetch(id,local,remote){var store=this,instance=Instances.get(this);var options,result,error,cacheError,context=this.__context;if(_.isObject(id)){options=id}else{options={id:id,locally:local,remotely:remote}}_.defaults(options,{locally:_.noop,remotely:_.noop});if(!options||!options.id){throw new Error("must specify an id")}result=dependencyResult(this,options);if(result){return result}cacheError=_.isUndefined(options.cacheError)||options.cacheError;if(cacheError){error=instance.failedFetches[options.id];if(error){return failed(error)}}if(instance.fetchInProgress[options.id]){return fetchResult.pending(options.id,store)}if(context){context.fetchStarted(store.id,options.id)}return tryAndGetLocally()||tryAndGetRemotely();function tryAndGetLocally(){try{var result=options.locally.call(store);if(_.isUndefined(result)){return}if(_.isNull(result)){return notFound()}finished();return fetchResult.done(result,options.id,store)}catch(error){failed(error);return fetchResult.failed(error,options.id,store)}}function tryAndGetRemotely(){try{result=options.remotely.call(store);if(result){if(_.isFunction(result.then)){instance.fetchInProgress[options.id]=true;result.then(function(){instance.fetchHistory[options.id]=true;result=tryAndGetLocally(store);if(result){finished();store.hasChanged()}else{notFound();store.hasChanged()}})["catch"](function(error){failed(error);store.hasChanged()});return fetchResult.pending(options.id,store)}else{instance.fetchHistory[options.id]=true;result=tryAndGetLocally(store);if(result){return result}}}if(warnings.promiseNotReturnedFromRemotely){log.warn(promiseNotReturnedWarning())}return notFound()}catch(error){return failed(error)}}function promiseNotReturnedWarning(){var inStore="";if(store.displayName){inStore=" in "+store.displayName}return"The remote fetch for '"+options.id+"'"+inStore+" did not return a promise and the state was "+"not present after remotely finished executing. "+"This might be because you forgot to return a promise."}function finished(){instance.fetchHistory[options.id]=true;delete instance.fetchInProgress[options.id];if(context){context.fetchFinished(store.id,options.id)}}function failed(error){if(cacheError){instance.failedFetches[options.id]=error}finished();return fetchResult.failed(error,options.id,store)}function notFound(){return failed(new NotFoundError,options.id,store)}}function dependencyResult(store,options){if(options.dependsOn){if(_.isArray(options.dependsOn)){var pending=false;var dependencyErrors=[];for(var i=0;i<options.dependsOn.length;i++){var dependency=options.dependsOn[i];switch(dependency.status){case StatusConstants.PENDING.toString():pending=true;break;case StatusConstants.FAILED.toString():dependencyErrors.push(dependency.error);break}}if(dependencyErrors.length){var error=new CompoundError(dependencyErrors);return fetchResult.failed(error,options.id,store)}if(pending){return fetchResult.pending(options.id,store)}}else{if(!options.dependsOn.done){return options.dependsOn}}}}fetch.done=fetchResult.done;fetch.failed=fetchResult.failed;fetch.pending=fetchResult.pending;fetch.notFound=fetchResult.notFound;module.exports=fetch},{"../../constants/status":3,"../../errors/compound":7,"../../errors/notFound":8,"../instances":26,"../logger":27,"../warnings":53,"./fetchResult":41,underscore:67}],41:[function(require,module,exports){"use strict";var when=require("./when");var NotFoundError=require("../../errors/notFound");module.exports={done:done,failed:failed,pending:pending,notFound:notFound};function pending(id,store){return fetchResult({id:id,pending:true,status:"PENDING"},store)}function failed(error,id,store){return fetchResult({id:id,error:error,failed:true,status:"FAILED"},store)}function done(result,id,store){return fetchResult({id:id,done:true,status:"DONE",result:result},store)}function notFound(id,store){return failed(new NotFoundError,id,store)}function fetchResult(result,store){result.when=when;result._isFetchResult=true;if(store){result.store=store.displayName||store.id}return result}},{"../../errors/notFound":8,"./when":46}],42:[function(require,module,exports){"use strict";var _=require("underscore");var log=require("../logger");var Instances=require("../instances");var ActionHandlerNotFoundError=require("../../errors/actionHandlerNotFound");function handleAction(action){Instances.get(this).validateHandlers();var store=this;var handlers=_.object(_.map(store.handlers,getHandlerWithPredicates));_.each(handlers,function(predicates,handlerName){_.each(predicates,function(predicate){if(predicate(action)){var rollbackHandler,actionHandler;var handler=action.addStoreHandler(store,handlerName,predicate.toJSON());try{store.action=action;actionHandler=store[handlerName];if(actionHandler){rollbackHandler=actionHandler.apply(store,action.arguments)}else{throw new ActionHandlerNotFoundError(handlerName,store)}}catch(e){var errorMessage="An error occured while trying to handle an '"+action.type.toString()+"' action in the action handler `"+handlerName+"`";var displayName=store.displayName||store.id;if(displayName){errorMessage+=" within the store "+displayName}log.error(errorMessage,e,action);handler.failed(e);throw e}finally{store.action=null;action.addRollbackHandler(rollbackHandler,store);if(handler){handler.dispose()}}}})})}function getHandlerWithPredicates(actionPredicates,handler){_.isArray(actionPredicates)||(actionPredicates=[actionPredicates]);var predicates=_.map(actionPredicates,toFunc);return[handler,predicates];function toFunc(actionPredicate){if(actionPredicate.isActionCreator){actionPredicate={type:actionPredicate.toString()}}else if(_.isString(actionPredicate)){actionPredicate={type:actionPredicate}}var func=_.matches(actionPredicate);func.toJSON=function(){return actionPredicate};return func}}module.exports=handleAction},{"../../errors/actionHandlerNotFound":5,"../instances":26,"../logger":27,underscore:67}],43:[function(require,module,exports){"use strict";module.exports=require("./store")},{"./store":44}],44:[function(require,module,exports){"use strict";var _prototypeProperties=function _prototypeProperties(child,staticProps,instanceProps){if(staticProps)Object.defineProperties(child,staticProps);if(instanceProps)Object.defineProperties(child.prototype,instanceProps)};var _classCallCheck=function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var CHANGE_EVENT="changed";var _=require("underscore");var log=require("../logger");var fetch=require("./fetch");var uuid=require("../utils/uuid");var warnings=require("../warnings");var Instances=require("../instances");var resolve=require("../utils/resolve");var Diagnostics=require("../diagnostics");var handleAction=require("./handleAction");var EventEmitter=require("events").EventEmitter;var validateHandlers=require("./validateHandlers");var DEFAULT_MAX_LISTENERS=1e6;function getInstance(store){return Instances.get(store)}var Store=function(){function Store(options){_classCallCheck(this,Store);options=options||{};this.__type="Store";this.__id=uuid.type(this.__type);var instance=Instances.add(this,_.extend({state:{},defaultState:{},fetchHistory:{},failedFetches:{},fetchInProgress:{},emitter:new EventEmitter},options));var emitter=instance.emitter;var dispatcher=instance.dispatcher;var initialState=this.getInitialState();emitter.setMaxListeners(DEFAULT_MAX_LISTENERS);if(_.isUndefined(initialState)){initialState={}}this.replaceState(initialState);this.dispatchToken=dispatcher.register(_.bind(this.handleAction,this));instance.validateHandlers=_.once(_.partial(validateHandlers,this))}_prototypeProperties(Store,null,{"for":{value:function _for(obj){return resolve(this,obj)},writable:true,configurable:true},context:{get:function get(){return getInstance(this).context},configurable:true},state:{get:function get(){return this.getState()},set:function set(newState){this.replaceState(newState)},configurable:true},getInitialState:{value:function getInitialState(){throw new Error("You must implement `getInitialState`")},writable:true,configurable:true},setInitialState:{value:function setInitialState(state){this.state=this.getInitialState(state)},writable:true,configurable:true},getState:{value:function getState(){return getInstance(this).state},writable:true,configurable:true},setState:{value:function setState(state){var newState=_.extend({},this.state,state);this.replaceState(newState)},writable:true,configurable:true},replaceState:{value:function replaceState(newState){var instance=getInstance(this);var currentState=instance.state;if(_.isUndefined(newState)||_.isNull(newState)){if(warnings.stateIsNullOrUndefined){var displayName=this.displayName||this.id;log.warn("Warning: Trying to replace the state of the store "+displayName+" with null or undefined")}}if(newState!==currentState){instance.state=newState;this.hasChanged()}},writable:true,configurable:true},clear:{value:function clear(){var instance=getInstance(this);instance.failedFetches={};instance.fetchInProgress={};this.state=this.getInitialState()},writable:true,configurable:true},dispose:{value:function dispose(){var instance=getInstance(this);var emitter=instance.emitter;var dispatchToken=this.dispatchToken;emitter.removeAllListeners(CHANGE_EVENT);this.clear();if(dispatchToken){instance.dispatcher.unregister(dispatchToken);this.dispatchToken=undefined}Instances.dispose(this)},writable:true,configurable:true},hasChanged:{value:function hasChanged(eventArgs){var instance=getInstance(this);if(instance){var emitter=instance.emitter;emitter.emit.call(emitter,CHANGE_EVENT,this.state,this,eventArgs)}},writable:true,configurable:true},hasAlreadyFetched:{value:function hasAlreadyFetched(fetchId){return!!getInstance(this).fetchHistory[fetchId]},writable:true,configurable:true},addChangeListener:{value:function addChangeListener(callback,context){var _this=this;var emitter=getInstance(this).emitter;if(context){callback=_.bind(callback,context)}Diagnostics.trace("The",this.displayName,"store ("+this.id+") is adding a change listener");emitter.on(CHANGE_EVENT,callback);return{dispose:function dispose(){Diagnostics.trace("The",_this.displayName,"store ("+_this.id+") is disposing of a change listener");emitter.removeListener(CHANGE_EVENT,callback)}}},writable:true,configurable:true},waitFor:{value:function waitFor(stores){var dispatcher=getInstance(this).dispatcher;if(!_.isArray(stores)){stores=_.toArray(arguments)}dispatcher.waitFor(dispatchTokens(stores));function dispatchTokens(stores){var tokens=[];_.each(stores,function(store){if(store.dispatchToken){tokens.push(store.dispatchToken)}if(_.isString(store)){tokens.push(store)}});return tokens}},writable:true,configurable:true}});return Store}();Store.prototype.fetch=fetch;Store.prototype.handleAction=handleAction;module.exports=Store},{"../diagnostics":22,"../instances":26,"../logger":27,"../utils/resolve":49,"../utils/uuid":52,"../warnings":53,"./fetch":40,"./handleAction":42,"./validateHandlers":45,events:59,underscore:67}],45:[function(require,module,exports){"use strict";var _=require("underscore");var ActionHandlerNotFoundError=require("../../errors/actionHandlerNotFound");var ActionPredicateUndefinedError=require("../../errors/actionPredicateUndefined");function validateHandlers(store){_.each(store.handlers,function(actionPredicate,handlerName){var actionHandler=store[handlerName];if(_.isUndefined(actionHandler)||_.isNull(actionHandler)){throw new ActionHandlerNotFoundError(handlerName,store)}if(!actionPredicate){throw new ActionPredicateUndefinedError(handlerName,store)}})}module.exports=validateHandlers},{"../../errors/actionHandlerNotFound":5,"../../errors/actionPredicateUndefined":6,underscore:67}],46:[function(require,module,exports){"use strict";var _=require("underscore");var log=require("../logger");var StatusConstants=require("../../constants/status");when.all=all;when.join=join;function when(handlers){handlers||(handlers={});var handler=handlers[this.status.toLowerCase()];if(!handler){throw new Error("Could not find a "+this.status+" handler")}try{switch(this.status){case StatusConstants.PENDING.toString():return handler.call(handlers);case StatusConstants.FAILED.toString():return handler.call(handlers,this.error);case StatusConstants.DONE.toString():return handler.call(handlers,this.result);default:throw new Error("Unknown fetch result status")}}catch(e){var errorMessage="An error occured when handling the DONE state of ";if(this.id){errorMessage+="the fetch '"+this.id+"'"}else{errorMessage+="a fetch"}if(this.store){errorMessage+=" from the store "+this.store}log.error(errorMessage,e);throw e}}function join(){return all(_.initial(arguments),_.last(arguments))}function all(fetchResults,handlers){if(!fetchResults||!handlers){throw new Error("No fetch results or handlers specified")}if(!_.isArray(fetchResults)||_.any(fetchResults,notFetchResult)){throw new Error("Must specify a set of fetch results")}var context={result:results(fetchResults),error:firstError(fetchResults),status:aggregateStatus(fetchResults)};return when.call(context,handlers)}function results(fetchResults){return fetchResults.map(function(result){return result.result})}function firstError(fetchResults){var failedResult=_.find(fetchResults,{status:StatusConstants.FAILED.toString()});if(failedResult){return failedResult.error}}function notFetchResult(result){return!result._isFetchResult}function aggregateStatus(fetchResults){for(var i=fetchResults.length-1;i>=0;i--){var status=fetchResults[i].status;if(status===StatusConstants.FAILED.toString()||status===StatusConstants.PENDING.toString()){return status}}return StatusConstants.DONE.toString()}module.exports=when},{"../../constants/status":3,"../logger":27,underscore:67}],47:[function(require,module,exports){"use strict";var uuid=require("./uuid");var log=require("../logger");var warnings=require("../warnings");function classId(clazz,type){if(clazz.id){return clazz.id}var displayName="";if(clazz.displayName){displayName=" '"+clazz.displayName+"'"}if(warnings.classDoesNotHaveAnId){log.warn("Warning: The "+type+displayName+" does not have an Id")}return clazz.displayName||uuid.generate()}module.exports=classId},{"../logger":27,"../warnings":53,"./uuid":52}],48:[function(require,module,exports){"use strict";var Context=require("../context");function getContext(obj){if(!obj){return}if(obj instanceof Context){return obj}if(obj.context instanceof Context){return obj.context}if(obj.__context instanceof Context){return obj.__context}}module.exports=getContext},{"../context":19}],49:[function(require,module,exports){"use strict";var getContext=require("./getContext");function resolve(obj,subject){var context=getContext(subject);if(context){return context.resolve(obj)}return obj}module.exports=resolve},{"./getContext":48}],50:[function(require,module,exports){"use strict";function serializeError(error){if(!error){return null}var result={name:error.name};Object.getOwnPropertyNames(error).forEach(function(key){result[key]=error[key]});return result}module.exports=serializeError},{}],51:[function(require,module,exports){"use strict";function timeout(time){return new Promise(function(resolve){setTimeout(resolve,time)})}module.exports=timeout},{}],52:[function(require,module,exports){"use strict";function generate(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}function small(){return s4()+s4()+s4()+s4()}function type(instanceType){return instanceType+"-"+s4()+s4()+s4()+s4()}function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}module.exports={type:type,small:small,generate:generate}},{}],53:[function(require,module,exports){"use strict";var _=require("underscore");var warnings={without:without,reservedFunction:true,classDoesNotHaveAnId:true,stateIsNullOrUndefined:true,callingResolverOnServer:true,stateSourceAlreadyExists:true,promiseNotReturnedFromRemotely:true};module.exports=warnings;
function without(warningsToDisable,cb,context){if(!_.isArray(warningsToDisable)){warningsToDisable=[warningsToDisable]}if(context){cb=_.bind(cb,context)}try{_.each(warningsToDisable,function(warning){warnings[warning]=false});cb()}finally{_.each(warningsToDisable,function(warning){warnings[warning]=true})}}},{underscore:67}],54:[function(require,module,exports){"use strict";module.exports=function(){};require("../../polyfill")},{"../../polyfill":55}],55:[function(require,module,exports){(function(global){"use strict";if(global._babelPolyfill){throw new Error("only one instance of babel/polyfill is allowed")}global._babelPolyfill=true;require("core-js/shim");require("regenerator-babel/runtime")}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"core-js/shim":56,"regenerator-babel/runtime":57}],56:[function(require,module,exports){!function(global,framework,undefined){"use strict";var OBJECT="Object",FUNCTION="Function",ARRAY="Array",STRING="String",NUMBER="Number",REGEXP="RegExp",DATE="Date",MAP="Map",SET="Set",WEAKMAP="WeakMap",WEAKSET="WeakSet",SYMBOL="Symbol",PROMISE="Promise",MATH="Math",ARGUMENTS="Arguments",PROTOTYPE="prototype",CONSTRUCTOR="constructor",TO_STRING="toString",TO_STRING_TAG=TO_STRING+"Tag",TO_LOCALE="toLocaleString",HAS_OWN="hasOwnProperty",FOR_EACH="forEach",ITERATOR="iterator",FF_ITERATOR="@@"+ITERATOR,PROCESS="process",CREATE_ELEMENT="createElement",Function=global[FUNCTION],Object=global[OBJECT],Array=global[ARRAY],String=global[STRING],Number=global[NUMBER],RegExp=global[REGEXP],Date=global[DATE],Map=global[MAP],Set=global[SET],WeakMap=global[WEAKMAP],WeakSet=global[WEAKSET],Symbol=global[SYMBOL],Math=global[MATH],TypeError=global.TypeError,RangeError=global.RangeError,setTimeout=global.setTimeout,setImmediate=global.setImmediate,clearImmediate=global.clearImmediate,parseInt=global.parseInt,isFinite=global.isFinite,process=global[PROCESS],nextTick=process&&process.nextTick,document=global.document,html=document&&document.documentElement,navigator=global.navigator,define=global.define,ArrayProto=Array[PROTOTYPE],ObjectProto=Object[PROTOTYPE],FunctionProto=Function[PROTOTYPE],Infinity=1/0,DOT=".",CONSOLE_METHODS="assert,clear,count,debug,dir,dirxml,error,exception,"+"group,groupCollapsed,groupEnd,info,isIndependentlyComposed,log,"+"markTimeline,profile,profileEnd,table,time,timeEnd,timeline,"+"timelineEnd,timeStamp,trace,warn";function isObject(it){return it!==null&&(typeof it=="object"||typeof it=="function")}function isFunction(it){return typeof it=="function"}var isNative=ctx(/./.test,/\[native code\]\s*\}\s*$/,1);var toString=ObjectProto[TO_STRING];function setToStringTag(it,tag,stat){if(it&&!has(it=stat?it:it[PROTOTYPE],SYMBOL_TAG))hidden(it,SYMBOL_TAG,tag)}function cof(it){return toString.call(it).slice(8,-1)}function classof(it){var O,T;return it==undefined?it===undefined?"Undefined":"Null":typeof(T=(O=Object(it))[SYMBOL_TAG])=="string"?T:cof(O)}var call=FunctionProto.call,apply=FunctionProto.apply,REFERENCE_GET;function part(){var fn=assertFunction(this),length=arguments.length,args=Array(length),i=0,_=path._,holder=false;while(length>i)if((args[i]=arguments[i++])===_)holder=true;return function(){var that=this,_length=arguments.length,i=0,j=0,_args;if(!holder&&!_length)return invoke(fn,args,that);_args=args.slice();if(holder)for(;length>i;i++)if(_args[i]===_)_args[i]=arguments[j++];while(_length>j)_args.push(arguments[j++]);return invoke(fn,_args,that)}}function ctx(fn,that,length){assertFunction(fn);if(~length&&that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}function invoke(fn,args,that){var un=that===undefined;switch(args.length|0){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3]);case 5:return un?fn(args[0],args[1],args[2],args[3],args[4]):fn.call(that,args[0],args[1],args[2],args[3],args[4])}return fn.apply(that,args)}function construct(target,argumentsList){var proto=assertFunction(arguments.length<3?target:arguments[2])[PROTOTYPE],instance=create(isObject(proto)?proto:ObjectProto),result=apply.call(target,instance,argumentsList);return isObject(result)?result:instance}var create=Object.create,getPrototypeOf=Object.getPrototypeOf,setPrototypeOf=Object.setPrototypeOf,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,getOwnDescriptor=Object.getOwnPropertyDescriptor,getKeys=Object.keys,getNames=Object.getOwnPropertyNames,getSymbols=Object.getOwnPropertySymbols,isFrozen=Object.isFrozen,has=ctx(call,ObjectProto[HAS_OWN],2),ES5Object=Object,Dict;function toObject(it){return ES5Object(assertDefined(it))}function returnIt(it){return it}function returnThis(){return this}function get(object,key){if(has(object,key))return object[key]}function ownKeys(it){assertObject(it);return getSymbols?getNames(it).concat(getSymbols(it)):getNames(it)}var assign=Object.assign||function(target,source){var T=Object(assertDefined(target)),l=arguments.length,i=1;while(l>i){var S=ES5Object(arguments[i++]),keys=getKeys(S),length=keys.length,j=0,key;while(length>j)T[key=keys[j++]]=S[key]}return T};function keyOf(object,el){var O=toObject(object),keys=getKeys(O),length=keys.length,index=0,key;while(length>index)if(O[key=keys[index++]]===el)return key}function array(it){return String(it).split(",")}var push=ArrayProto.push,unshift=ArrayProto.unshift,slice=ArrayProto.slice,splice=ArrayProto.splice,indexOf=ArrayProto.indexOf,forEach=ArrayProto[FOR_EACH];function createArrayMethod(type){var isMap=type==1,isFilter=type==2,isSome=type==3,isEvery=type==4,isFindIndex=type==6,noholes=type==5||isFindIndex;return function(callbackfn){var O=Object(assertDefined(this)),that=arguments[1],self=ES5Object(O),f=ctx(callbackfn,that,3),length=toLength(self.length),index=0,result=isMap?Array(length):isFilter?[]:undefined,val,res;for(;length>index;index++)if(noholes||index in self){val=self[index];res=f(val,index,O);if(type){if(isMap)result[index]=res;else if(res)switch(type){case 3:return true;case 5:return val;case 6:return index;case 2:result.push(val)}else if(isEvery)return false}}return isFindIndex?-1:isSome||isEvery?isEvery:result}}function createArrayContains(isContains){return function(el){var O=toObject(this),length=toLength(O.length),index=toIndex(arguments[1],length);if(isContains&&el!=el){for(;length>index;index++)if(sameNaN(O[index]))return isContains||index}else for(;length>index;index++)if(isContains||index in O){if(O[index]===el)return isContains||index}return!isContains&&-1}}function generic(A,B){return typeof A=="function"?A:B}var MAX_SAFE_INTEGER=9007199254740991,pow=Math.pow,abs=Math.abs,ceil=Math.ceil,floor=Math.floor,max=Math.max,min=Math.min,random=Math.random,trunc=Math.trunc||function(it){return(it>0?floor:ceil)(it)};function sameNaN(number){return number!=number}function toInteger(it){return isNaN(it)?0:trunc(it)}function toLength(it){return it>0?min(toInteger(it),MAX_SAFE_INTEGER):0}function toIndex(index,length){var index=toInteger(index);return index<0?max(index+length,0):min(index,length)}function lz(num){return num>9?num:"0"+num}function createReplacer(regExp,replace,isStatic){var replacer=isObject(replace)?function(part){return replace[part]}:replace;return function(it){return String(isStatic?it:this).replace(regExp,replacer)}}function createPointAt(toString){return function(pos){var s=String(assertDefined(this)),i=toInteger(pos),l=s.length,a,b;if(i<0||i>=l)return toString?"":undefined;a=s.charCodeAt(i);return a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?toString?s.charAt(i):a:toString?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536}}var REDUCE_ERROR="Reduce of empty object with no initial value";function assert(condition,msg1,msg2){if(!condition)throw TypeError(msg2?msg1+msg2:msg1)}function assertDefined(it){if(it==undefined)throw TypeError("Function called on null or undefined");return it}function assertFunction(it){assert(isFunction(it),it," is not a function!");return it}function assertObject(it){assert(isObject(it),it," is not an object!");return it}function assertInstance(it,Constructor,name){assert(it instanceof Constructor,name,": use the 'new' operator!")}function descriptor(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}function simpleSet(object,key,value){object[key]=value;return object}function createDefiner(bitmap){return DESC?function(object,key,value){return defineProperty(object,key,descriptor(bitmap,value))}:simpleSet}function uid(key){return SYMBOL+"("+key+")_"+(++sid+random())[TO_STRING](36)}function getWellKnownSymbol(name,setter){return Symbol&&Symbol[name]||(setter?Symbol:safeSymbol)(SYMBOL+DOT+name)}var DESC=!!function(){try{return defineProperty({},"a",{get:function(){return 2}}).a==2}catch(e){}}(),sid=0,hidden=createDefiner(1),set=Symbol?simpleSet:hidden,safeSymbol=Symbol||uid;function assignHidden(target,src){for(var key in src)hidden(target,key,src[key]);return target}var SYMBOL_UNSCOPABLES=getWellKnownSymbol("unscopables"),ArrayUnscopables=ArrayProto[SYMBOL_UNSCOPABLES]||{},SYMBOL_SPECIES=getWellKnownSymbol("species");function setSpecies(C){if(framework||!isNative(C))defineProperty(C,SYMBOL_SPECIES,{configurable:true,get:returnThis})}var SYMBOL_ITERATOR=getWellKnownSymbol(ITERATOR),SYMBOL_TAG=getWellKnownSymbol(TO_STRING_TAG),SUPPORT_FF_ITER=FF_ITERATOR in ArrayProto,ITER=safeSymbol("iter"),KEY=1,VALUE=2,Iterators={},IteratorPrototype={},NATIVE_ITERATORS=SYMBOL_ITERATOR in ArrayProto,BUGGY_ITERATORS="keys"in ArrayProto&&!("next"in[].keys());setIterator(IteratorPrototype,returnThis);function setIterator(O,value){hidden(O,SYMBOL_ITERATOR,value);SUPPORT_FF_ITER&&hidden(O,FF_ITERATOR,value)}function createIterator(Constructor,NAME,next,proto){Constructor[PROTOTYPE]=create(proto||IteratorPrototype,{next:descriptor(1,next)});setToStringTag(Constructor,NAME+" Iterator")}function defineIterator(Constructor,NAME,value,DEFAULT){var proto=Constructor[PROTOTYPE],iter=get(proto,SYMBOL_ITERATOR)||get(proto,FF_ITERATOR)||DEFAULT&&get(proto,DEFAULT)||value;if(framework){setIterator(proto,iter);if(iter!==value){var iterProto=getPrototypeOf(iter.call(new Constructor));setToStringTag(iterProto,NAME+" Iterator",true);has(proto,FF_ITERATOR)&&setIterator(iterProto,returnThis)}}Iterators[NAME]=iter;Iterators[NAME+" Iterator"]=returnThis;return iter}function defineStdIterators(Base,NAME,Constructor,next,DEFAULT,IS_SET){function createIter(kind){return function(){return new Constructor(this,kind)}}createIterator(Constructor,NAME,next);var entries=createIter(KEY+VALUE),values=createIter(VALUE);if(DEFAULT==VALUE)values=defineIterator(Base,NAME,values,"values");else entries=defineIterator(Base,NAME,entries,"entries");if(DEFAULT){$define(PROTO+FORCED*BUGGY_ITERATORS,NAME,{entries:entries,keys:IS_SET?values:createIter(KEY),values:values})}}function iterResult(done,value){return{value:value,done:!!done}}function isIterable(it){var O=Object(it),Symbol=global[SYMBOL],hasExt=(Symbol&&Symbol[ITERATOR]||FF_ITERATOR)in O;return hasExt||SYMBOL_ITERATOR in O||has(Iterators,classof(O))}function getIterator(it){var Symbol=global[SYMBOL],ext=it[Symbol&&Symbol[ITERATOR]||FF_ITERATOR],getIter=ext||it[SYMBOL_ITERATOR]||Iterators[classof(it)];return assertObject(getIter.call(it))}function stepCall(fn,value,entries){return entries?invoke(fn,value):fn(value)}function forOf(iterable,entries,fn,that){var iterator=getIterator(iterable),f=ctx(fn,that,entries?2:1),step;while(!(step=iterator.next()).done)if(stepCall(f,step.value,entries)===false)return}var NODE=cof(process)==PROCESS,core={},path=framework?global:core,old=global.core,exportGlobal,FORCED=1,GLOBAL=2,STATIC=4,PROTO=8,BIND=16,WRAP=32,SIMPLE=64;function $define(type,name,source){var key,own,out,exp,isGlobal=type&GLOBAL,target=isGlobal?global:type&STATIC?global[name]:(global[name]||ObjectProto)[PROTOTYPE],exports=isGlobal?core:core[name]||(core[name]={});if(isGlobal)source=name;for(key in source){own=!(type&FORCED)&&target&&key in target&&(!isFunction(target[key])||isNative(target[key]));out=(own?target:source)[key];if(!framework&&isGlobal&&!isFunction(target[key]))exp=source[key];else if(type&BIND&&own)exp=ctx(out,global);else if(type&WRAP&&!framework&&target[key]==out){exp=function(param){return this instanceof out?new out(param):out(param)};exp[PROTOTYPE]=out[PROTOTYPE]}else exp=type&PROTO&&isFunction(out)?ctx(call,out):out;if(framework&&target&&!own){if(isGlobal||type&SIMPLE)target[key]=out;else delete target[key]&&hidden(target,key,out)}if(exports[key]!=out)hidden(exports,key,exp)}}if(typeof module!="undefined"&&module.exports)module.exports=core;else if(isFunction(define)&&define.amd)define(function(){return core});else exportGlobal=true;if(exportGlobal||framework){core.noConflict=function(){global.core=old;return core};global.core=core}!function(TAG,SymbolRegistry,AllSymbols,setter){if(!isNative(Symbol)){Symbol=function(description){assert(!(this instanceof Symbol),SYMBOL+" is not a "+CONSTRUCTOR);var tag=uid(description),sym=set(create(Symbol[PROTOTYPE]),TAG,tag);AllSymbols[tag]=sym;DESC&&setter&&defineProperty(ObjectProto,tag,{configurable:true,set:function(value){hidden(this,tag,value)}});return sym};hidden(Symbol[PROTOTYPE],TO_STRING,function(){return this[TAG]})}$define(GLOBAL+WRAP,{Symbol:Symbol});var symbolStatics={"for":function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=Symbol(key)},iterator:SYMBOL_ITERATOR,keyFor:part.call(keyOf,SymbolRegistry),species:SYMBOL_SPECIES,toStringTag:SYMBOL_TAG=getWellKnownSymbol(TO_STRING_TAG,true),unscopables:SYMBOL_UNSCOPABLES,pure:safeSymbol,set:set,useSetter:function(){setter=true},useSimple:function(){setter=false}};forEach.call(array("hasInstance,isConcatSpreadable,match,replace,search,split,toPrimitive"),function(it){symbolStatics[it]=getWellKnownSymbol(it)});$define(STATIC,SYMBOL,symbolStatics);setToStringTag(Symbol,SYMBOL);$define(STATIC+FORCED*!isNative(Symbol),OBJECT,{getOwnPropertyNames:function(it){var names=getNames(toObject(it)),result=[],key,i=0;while(names.length>i)has(AllSymbols,key=names[i++])||result.push(key);return result},getOwnPropertySymbols:function(it){var names=getNames(toObject(it)),result=[],key,i=0;while(names.length>i)has(AllSymbols,key=names[i++])&&result.push(AllSymbols[key]);return result}})}(safeSymbol("tag"),{},{},true);!function(tmp){var objectStatic={assign:assign,is:function(x,y){return x===y?x!==0||1/x===1/y:x!=x&&y!=y}};"__proto__"in ObjectProto&&function(buggy,set){try{set=ctx(call,getOwnDescriptor(ObjectProto,"__proto__").set,2);set({},ArrayProto)}catch(e){buggy=true}objectStatic.setPrototypeOf=setPrototypeOf=setPrototypeOf||function(O,proto){assertObject(O);assert(proto===null||isObject(proto),proto,": can't set as prototype!");if(buggy)O.__proto__=proto;else set(O,proto);return O}}();$define(STATIC,OBJECT,objectStatic);if(framework){tmp[SYMBOL_TAG]=DOT;if(cof(tmp)!=DOT)hidden(ObjectProto,TO_STRING,function(){return"[object "+classof(this)+"]"})}setToStringTag(Math,MATH,true);setToStringTag(global.JSON,"JSON",true)}({});!function(){function wrapObjectMethod(key,MODE){var fn=Object[key],exp=core[OBJECT][key],f=0,o={};if(!exp||isNative(exp)){o[key]=MODE==1?function(it){return isObject(it)?fn(it):it}:MODE==2?function(it){return isObject(it)?fn(it):true}:MODE==3?function(it){return isObject(it)?fn(it):false}:MODE==4?function(it,key){return fn(toObject(it),key)}:function(it){return fn(toObject(it))};try{fn(DOT)}catch(e){f=1}$define(STATIC+FORCED*f,OBJECT,o)}}wrapObjectMethod("freeze",1);wrapObjectMethod("seal",1);wrapObjectMethod("preventExtensions",1);wrapObjectMethod("isFrozen",2);wrapObjectMethod("isSealed",2);wrapObjectMethod("isExtensible",3);wrapObjectMethod("getOwnPropertyDescriptor",4);wrapObjectMethod("getPrototypeOf");wrapObjectMethod("keys");wrapObjectMethod("getOwnPropertyNames")}();!function(NAME){NAME in FunctionProto||defineProperty(FunctionProto,NAME,{configurable:true,get:function(){var match=String(this).match(/^\s*function ([^ (]*)/),name=match?match[1]:"";has(this,NAME)||defineProperty(this,NAME,descriptor(5,name));return name},set:function(value){has(this,NAME)||defineProperty(this,NAME,descriptor(0,value))}})}("name");Number("0o1")&&Number("0b1")||function(_Number,NumberProto){function toNumber(it){if(isObject(it))it=toPrimitive(it);if(typeof it=="string"&&it.length>2&&it.charCodeAt(0)==48){var binary=false;switch(it.charCodeAt(1)){case 66:case 98:binary=true;case 79:case 111:return parseInt(it.slice(2),binary?2:8)}}return+it}function toPrimitive(it){var fn,val;if(isFunction(fn=it.valueOf)&&!isObject(val=fn.call(it)))return val;if(isFunction(fn=it[TO_STRING])&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to number")}Number=function Number(it){return this instanceof Number?new _Number(toNumber(it)):toNumber(it)};forEach.call(DESC?getNames(_Number):array("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY"),function(key){key in Number||defineProperty(Number,key,getOwnDescriptor(_Number,key))});Number[PROTOTYPE]=NumberProto;NumberProto[CONSTRUCTOR]=Number;hidden(global,NUMBER,Number)}(Number,Number[PROTOTYPE]);!function(isInteger){$define(STATIC,NUMBER,{EPSILON:pow(2,-52),isFinite:function(it){return typeof it=="number"&&isFinite(it)},isInteger:isInteger,isNaN:sameNaN,isSafeInteger:function(number){return isInteger(number)&&abs(number)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER:MAX_SAFE_INTEGER,MIN_SAFE_INTEGER:-MAX_SAFE_INTEGER,parseFloat:parseFloat,parseInt:parseInt})}(Number.isInteger||function(it){return!isObject(it)&&isFinite(it)&&floor(it)===it});!function(){var E=Math.E,exp=Math.exp,log=Math.log,sqrt=Math.sqrt,sign=Math.sign||function(x){return(x=+x)==0||x!=x?x:x<0?-1:1};function asinh(x){return!isFinite(x=+x)||x==0?x:x<0?-asinh(-x):log(x+sqrt(x*x+1))}function expm1(x){return(x=+x)==0?x:x>-1e-6&&x<1e-6?x+x*x/2:exp(x)-1}$define(STATIC,MATH,{acosh:function(x){return(x=+x)<1?NaN:isFinite(x)?log(x/E+sqrt(x+1)*sqrt(x-1)/E)+1:x},asinh:asinh,atanh:function(x){return(x=+x)==0?x:log((1+x)/(1-x))/2},cbrt:function(x){return sign(x=+x)*pow(abs(x),1/3)},clz32:function(x){return(x>>>=0)?32-x[TO_STRING](2).length:32},cosh:function(x){return(exp(x=+x)+exp(-x))/2},expm1:expm1,fround:function(x){return new Float32Array([x])[0]},hypot:function(value1,value2){var sum=0,len1=arguments.length,len2=len1,args=Array(len1),larg=-Infinity,arg;while(len1--){arg=args[len1]=+arguments[len1];if(arg==Infinity||arg==-Infinity)return Infinity;if(arg>larg)larg=arg}larg=arg||1;while(len2--)sum+=pow(args[len2]/larg,2);return larg*sqrt(sum)},imul:function(x,y){var UInt16=65535,xn=+x,yn=+y,xl=UInt16&xn,yl=UInt16&yn;return 0|xl*yl+((UInt16&xn>>>16)*yl+xl*(UInt16&yn>>>16)<<16>>>0)},log1p:function(x){return(x=+x)>-1e-8&&x<1e-8?x-x*x/2:log(1+x)},log10:function(x){return log(x)/Math.LN10},log2:function(x){return log(x)/Math.LN2},sign:sign,sinh:function(x){return abs(x=+x)<1?(expm1(x)-expm1(-x))/2:(exp(x-1)-exp(-x-1))*(E/2)},tanh:function(x){var a=expm1(x=+x),b=expm1(-x);return a==Infinity?1:b==Infinity?-1:(a-b)/(exp(x)+exp(-x))},trunc:trunc})}();!function(fromCharCode){function assertNotRegExp(it){if(cof(it)==REGEXP)throw TypeError()}$define(STATIC,STRING,{fromCodePoint:function(x){var res=[],len=arguments.length,i=0,code;while(len>i){code=+arguments[i++];if(toIndex(code,1114111)!==code)throw RangeError(code+" is not a valid code point");res.push(code<65536?fromCharCode(code):fromCharCode(((code-=65536)>>10)+55296,code%1024+56320))}return res.join("")},raw:function(callSite){var raw=toObject(callSite.raw),len=toLength(raw.length),sln=arguments.length,res=[],i=0;while(len>i){res.push(String(raw[i++]));if(i<sln)res.push(String(arguments[i]))}return res.join("")}});$define(PROTO,STRING,{codePointAt:createPointAt(false),endsWith:function(searchString){assertNotRegExp(searchString);var that=String(assertDefined(this)),endPosition=arguments[1],len=toLength(that.length),end=endPosition===undefined?len:min(toLength(endPosition),len);searchString+="";return that.slice(end-searchString.length,end)===searchString},includes:function(searchString){assertNotRegExp(searchString);return!!~String(assertDefined(this)).indexOf(searchString,arguments[1])},repeat:function(count){var str=String(assertDefined(this)),res="",n=toInteger(count);if(0>n||n==Infinity)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(str+=str))if(n&1)res+=str;return res},startsWith:function(searchString){assertNotRegExp(searchString);var that=String(assertDefined(this)),index=toLength(min(arguments[1],that.length));searchString+="";return that.slice(index,index+searchString.length)===searchString}})}(String.fromCharCode);!function(){$define(STATIC,ARRAY,{from:function(arrayLike){var O=Object(assertDefined(arrayLike)),mapfn=arguments[1],mapping=mapfn!==undefined,f=mapping?ctx(mapfn,arguments[2],2):undefined,index=0,length,result,iter,step;if(isIterable(O))for(iter=getIterator(O),result=new(generic(this,Array));!(step=iter.next()).done;index++){result[index]=mapping?f(step.value,index):step.value}else for(result=new(generic(this,Array))(length=toLength(O.length));length>index;index++){result[index]=mapping?f(O[index],index):O[index]}result.length=index;return result},of:function(){var index=0,length=arguments.length,result=new(generic(this,Array))(length);while(length>index)result[index]=arguments[index++];result.length=length;return result}});$define(PROTO,ARRAY,{copyWithin:function(target,start){var O=Object(assertDefined(this)),len=toLength(O.length),to=toIndex(target,len),from=toIndex(start,len),end=arguments[2],fin=end===undefined?len:toIndex(end,len),count=min(fin-from,len-to),inc=1;if(from<to&&to<from+count){inc=-1;from=from+count-1;to=to+count-1}while(count-->0){if(from in O)O[to]=O[from];else delete O[to];to+=inc;from+=inc}return O},fill:function(value){var O=Object(assertDefined(this)),length=toLength(O.length),index=toIndex(arguments[1],length),end=arguments[2],endPos=end===undefined?length:toIndex(end,length);while(endPos>index)O[index++]=value;return O},find:createArrayMethod(5),findIndex:createArrayMethod(6)});if(framework){forEach.call(array("find,findIndex,fill,copyWithin,entries,keys,values"),function(it){ArrayUnscopables[it]=true});SYMBOL_UNSCOPABLES in ArrayProto||hidden(ArrayProto,SYMBOL_UNSCOPABLES,ArrayUnscopables)}setSpecies(Array)}();!function(at){defineStdIterators(Array,ARRAY,function(iterated,kind){set(this,ITER,{o:toObject(iterated),i:0,k:kind})},function(){var iter=this[ITER],O=iter.o,kind=iter.k,index=iter.i++;if(!O||index>=O.length){iter.o=undefined;return iterResult(1)}if(kind==KEY)return iterResult(0,index);if(kind==VALUE)return iterResult(0,O[index]);return iterResult(0,[index,O[index]])},VALUE);Iterators[ARGUMENTS]=Iterators[ARRAY];defineStdIterators(String,STRING,function(iterated){set(this,ITER,{o:String(iterated),i:0})},function(){var iter=this[ITER],O=iter.o,index=iter.i,point;if(index>=O.length)return iterResult(1);point=at.call(O,index);iter.i+=point.length;return iterResult(0,point)})}(createPointAt(true));!function(RegExpProto,_RegExp){function assertRegExpWrapper(fn){return function(){assert(cof(this)===REGEXP);return fn(this)}}if(DESC&&!function(){try{return RegExp(/a/g,"i")=="/a/i"}catch(e){}}()){RegExp=function RegExp(pattern,flags){return new _RegExp(cof(pattern)==REGEXP&&flags!==undefined?pattern.source:pattern,flags)};forEach.call(getNames(_RegExp),function(key){key in RegExp||defineProperty(RegExp,key,{configurable:true,get:function(){return _RegExp[key]},set:function(it){_RegExp[key]=it}})});RegExpProto[CONSTRUCTOR]=RegExp;RegExp[PROTOTYPE]=RegExpProto;hidden(global,REGEXP,RegExp)}if(/./g.flags!="g")defineProperty(RegExpProto,"flags",{configurable:true,get:assertRegExpWrapper(createReplacer(/^.*\/(\w*)$/,"$1",true))});forEach.call(array("sticky,unicode"),function(key){key in/./||defineProperty(RegExpProto,key,DESC?{configurable:true,get:assertRegExpWrapper(function(){return false})}:descriptor(5,false))});setSpecies(RegExp)}(RegExp[PROTOTYPE],RegExp);isFunction(setImmediate)&&isFunction(clearImmediate)||function(ONREADYSTATECHANGE){var postMessage=global.postMessage,addEventListener=global.addEventListener,MessageChannel=global.MessageChannel,counter=0,queue={},defer,channel,port;setImmediate=function(fn){var args=[],i=1;while(arguments.length>i)args.push(arguments[i++]);queue[++counter]=function(){invoke(isFunction(fn)?fn:Function(fn),args)};defer(counter);return counter};clearImmediate=function(id){delete queue[id]};function run(id){if(has(queue,id)){var fn=queue[id];delete queue[id];fn()}}function listner(event){run(event.data)}if(NODE){defer=function(id){nextTick(part.call(run,id))}}else if(addEventListener&&isFunction(postMessage)&&!global.importScripts){defer=function(id){postMessage(id,"*")};addEventListener("message",listner,false)}else if(isFunction(MessageChannel)){channel=new MessageChannel;port=channel.port2;channel.port1.onmessage=listner;defer=ctx(port.postMessage,port,1)}else if(document&&ONREADYSTATECHANGE in document[CREATE_ELEMENT]("script")){defer=function(id){html.appendChild(document[CREATE_ELEMENT]("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this);run(id)}}}else{defer=function(id){setTimeout(run,0,id)}}}("onreadystatechange");$define(GLOBAL+BIND,{setImmediate:setImmediate,clearImmediate:clearImmediate});!function(Promise,test){isFunction(Promise)&&isFunction(Promise.resolve)&&Promise.resolve(test=new Promise(function(){}))==test||function(asap,DEF){function isThenable(o){var then;if(isObject(o))then=o.then;return isFunction(then)?then:false}function notify(def){var chain=def.chain;chain.length&&asap(function(){var msg=def.msg,ok=def.state==1,i=0;while(chain.length>i)!function(react){var cb=ok?react.ok:react.fail,ret,then;try{if(cb){ret=cb===true?msg:cb(msg);if(ret===react.P){react.rej(TypeError(PROMISE+"-chain cycle"))}else if(then=isThenable(ret)){then.call(ret,react.res,react.rej)}else react.res(ret)}else react.rej(msg)}catch(err){react.rej(err)}}(chain[i++]);chain.length=0})}function resolve(msg){var def=this,then,wrapper;if(def.done)return;def.done=true;def=def.def||def;try{if(then=isThenable(msg)){wrapper={def:def,done:false};then.call(msg,ctx(resolve,wrapper,1),ctx(reject,wrapper,1))}else{def.msg=msg;def.state=1;notify(def)}}catch(err){reject.call(wrapper||{def:def,done:false},err)}}function reject(msg){var def=this;if(def.done)return;def.done=true;def=def.def||def;def.msg=msg;def.state=2;notify(def)}function getConstructor(C){var S=assertObject(C)[SYMBOL_SPECIES];return S!=undefined?S:C}Promise=function(executor){assertFunction(executor);assertInstance(this,Promise,PROMISE);var def={chain:[],state:0,done:false,msg:undefined};hidden(this,DEF,def);try{executor(ctx(resolve,def,1),ctx(reject,def,1))}catch(err){reject.call(def,err)}};assignHidden(Promise[PROTOTYPE],{then:function(onFulfilled,onRejected){var S=assertObject(assertObject(this)[CONSTRUCTOR])[SYMBOL_SPECIES];var react={ok:isFunction(onFulfilled)?onFulfilled:true,fail:isFunction(onRejected)?onRejected:false},P=react.P=new(S!=undefined?S:Promise)(function(resolve,reject){react.res=assertFunction(resolve);react.rej=assertFunction(reject)}),def=this[DEF];def.chain.push(react);def.state&&notify(def);return P},"catch":function(onRejected){return this.then(undefined,onRejected)}});assignHidden(Promise,{all:function(iterable){var Promise=getConstructor(this),values=[];return new Promise(function(resolve,reject){forOf(iterable,false,push,values);var remaining=values.length,results=Array(remaining);if(remaining)forEach.call(values,function(promise,index){Promise.resolve(promise).then(function(value){results[index]=value;--remaining||resolve(results)},reject)});else resolve(results)})},race:function(iterable){var Promise=getConstructor(this);return new Promise(function(resolve,reject){forOf(iterable,false,function(promise){Promise.resolve(promise).then(resolve,reject)})})},reject:function(r){return new(getConstructor(this))(function(resolve,reject){reject(r)})},resolve:function(x){return isObject(x)&&DEF in x&&getPrototypeOf(x)===this[PROTOTYPE]?x:new(getConstructor(this))(function(resolve,reject){resolve(x)})}})}(nextTick||setImmediate,safeSymbol("def"));setToStringTag(Promise,PROMISE);setSpecies(Promise);$define(GLOBAL+FORCED*!isNative(Promise),{Promise:Promise})}(global[PROMISE]);!function(){var UID=safeSymbol("uid"),O1=safeSymbol("O1"),WEAK=safeSymbol("weak"),LEAK=safeSymbol("leak"),LAST=safeSymbol("last"),FIRST=safeSymbol("first"),SIZE=DESC?safeSymbol("size"):"size",uid=0,tmp={};function getCollection(C,NAME,methods,commonMethods,isMap,isWeak){var ADDER=isMap?"set":"add",proto=C&&C[PROTOTYPE],O={};function initFromIterable(that,iterable){if(iterable!=undefined)forOf(iterable,isMap,that[ADDER],that);return that}function fixSVZ(key,chain){var method=proto[key];if(framework)proto[key]=function(a,b){var result=method.call(this,a===0?0:a,b);return chain?this:result}}if(!isNative(C)||!(isWeak||!BUGGY_ITERATORS&&has(proto,FOR_EACH)&&has(proto,"entries"))){C=isWeak?function(iterable){assertInstance(this,C,NAME);set(this,UID,uid++);initFromIterable(this,iterable)}:function(iterable){var that=this;assertInstance(that,C,NAME);set(that,O1,create(null));set(that,SIZE,0);set(that,LAST,undefined);set(that,FIRST,undefined);initFromIterable(that,iterable)};assignHidden(assignHidden(C[PROTOTYPE],methods),commonMethods);isWeak||defineProperty(C[PROTOTYPE],"size",{get:function(){return assertDefined(this[SIZE])}})}else{var Native=C,inst=new C,chain=inst[ADDER](isWeak?{}:-0,1),buggyZero;if(!NATIVE_ITERATORS||!C.length){C=function(iterable){assertInstance(this,C,NAME);return initFromIterable(new Native,iterable)};C[PROTOTYPE]=proto;if(framework)proto[CONSTRUCTOR]=C}isWeak||inst[FOR_EACH](function(val,key){buggyZero=1/key===-Infinity});if(buggyZero){fixSVZ("delete");fixSVZ("has");isMap&&fixSVZ("get")}if(buggyZero||chain!==inst)fixSVZ(ADDER,true)}setToStringTag(C,NAME);setSpecies(C);O[NAME]=C;$define(GLOBAL+WRAP+FORCED*!isNative(C),O);isWeak||defineStdIterators(C,NAME,function(iterated,kind){set(this,ITER,{o:iterated,k:kind})},function(){var iter=this[ITER],kind=iter.k,entry=iter.l;while(entry&&entry.r)entry=entry.p;if(!iter.o||!(iter.l=entry=entry?entry.n:iter.o[FIRST])){iter.o=undefined;return iterResult(1)}if(kind==KEY)return iterResult(0,entry.k);if(kind==VALUE)return iterResult(0,entry.v);return iterResult(0,[entry.k,entry.v])},isMap?KEY+VALUE:VALUE,!isMap);return C}function fastKey(it,create){if(!isObject(it))return(typeof it=="string"?"S":"P")+it;if(isFrozen(it))return"F";if(!has(it,UID)){if(!create)return"E";hidden(it,UID,++uid)}return"O"+it[UID]}function getEntry(that,key){var index=fastKey(key),entry;if(index!="F")return that[O1][index];for(entry=that[FIRST];entry;entry=entry.n){if(entry.k==key)return entry}}function def(that,key,value){var entry=getEntry(that,key),prev,index;if(entry)entry.v=value;else{that[LAST]=entry={i:index=fastKey(key,true),k:key,v:value,p:prev=that[LAST],n:undefined,r:false};if(!that[FIRST])that[FIRST]=entry;if(prev)prev.n=entry;that[SIZE]++;if(index!="F")that[O1][index]=entry}return that}var collectionMethods={clear:function(){for(var that=this,data=that[O1],entry=that[FIRST];entry;entry=entry.n){entry.r=true;if(entry.p)entry.p=entry.p.n=undefined;delete data[entry.i]}that[FIRST]=that[LAST]=undefined;that[SIZE]=0},"delete":function(key){var that=this,entry=getEntry(that,key);if(entry){var next=entry.n,prev=entry.p;delete that[O1][entry.i];entry.r=true;if(prev)prev.n=next;if(next)next.p=prev;if(that[FIRST]==entry)that[FIRST]=next;
if(that[LAST]==entry)that[LAST]=prev;that[SIZE]--}return!!entry},forEach:function(callbackfn){var f=ctx(callbackfn,arguments[1],3),entry;while(entry=entry?entry.n:this[FIRST]){f(entry.v,entry.k,this);while(entry&&entry.r)entry=entry.p}},has:function(key){return!!getEntry(this,key)}};Map=getCollection(Map,MAP,{get:function(key){var entry=getEntry(this,key);return entry&&entry.v},set:function(key,value){return def(this,key===0?0:key,value)}},collectionMethods,true);Set=getCollection(Set,SET,{add:function(value){return def(this,value=value===0?0:value,value)}},collectionMethods);function defWeak(that,key,value){if(isFrozen(assertObject(key)))leakStore(that).set(key,value);else{has(key,WEAK)||hidden(key,WEAK,{});key[WEAK][that[UID]]=value}return that}function leakStore(that){return that[LEAK]||hidden(that,LEAK,new Map)[LEAK]}var weakMethods={"delete":function(key){if(!isObject(key))return false;if(isFrozen(key))return leakStore(this)["delete"](key);return has(key,WEAK)&&has(key[WEAK],this[UID])&&delete key[WEAK][this[UID]]},has:function(key){if(!isObject(key))return false;if(isFrozen(key))return leakStore(this).has(key);return has(key,WEAK)&&has(key[WEAK],this[UID])}};WeakMap=getCollection(WeakMap,WEAKMAP,{get:function(key){if(isObject(key)){if(isFrozen(key))return leakStore(this).get(key);if(has(key,WEAK))return key[WEAK][this[UID]]}},set:function(key,value){return defWeak(this,key,value)}},weakMethods,true,true);if(framework&&(new WeakMap).set(Object.freeze(tmp),7).get(tmp)!=7){forEach.call(array("delete,has,get,set"),function(key){var method=WeakMap[PROTOTYPE][key];WeakMap[PROTOTYPE][key]=function(a,b){if(isObject(a)&&isFrozen(a)){var result=leakStore(this)[key](a,b);return key=="set"?this:result}return method.call(this,a,b)}})}WeakSet=getCollection(WeakSet,WEAKSET,{add:function(value){return defWeak(this,value,true)}},weakMethods,false,true)}();!function(){function Enumerate(iterated){var keys=[],key;for(key in iterated)keys.push(key);set(this,ITER,{o:iterated,a:keys,i:0})}createIterator(Enumerate,OBJECT,function(){var iter=this[ITER],keys=iter.a,key;do{if(iter.i>=keys.length)return iterResult(1)}while(!((key=keys[iter.i++])in iter.o));return iterResult(0,key)});function wrap(fn){return function(it){assertObject(it);try{return fn.apply(undefined,arguments),true}catch(e){return false}}}function reflectGet(target,propertyKey){var receiver=arguments.length<3?target:arguments[2],desc=getOwnDescriptor(assertObject(target),propertyKey),proto;if(desc)return has(desc,"value")?desc.value:desc.get===undefined?undefined:desc.get.call(receiver);return isObject(proto=getPrototypeOf(target))?reflectGet(proto,propertyKey,receiver):undefined}function reflectSet(target,propertyKey,V){var receiver=arguments.length<4?target:arguments[3],ownDesc=getOwnDescriptor(assertObject(target),propertyKey),existingDescriptor,proto;if(!ownDesc){if(isObject(proto=getPrototypeOf(target))){return reflectSet(proto,propertyKey,V,receiver)}ownDesc=descriptor(0)}if(has(ownDesc,"value")){if(ownDesc.writable===false||!isObject(receiver))return false;existingDescriptor=getOwnDescriptor(receiver,propertyKey)||descriptor(0);existingDescriptor.value=V;return defineProperty(receiver,propertyKey,existingDescriptor),true}return ownDesc.set===undefined?false:(ownDesc.set.call(receiver,V),true)}var isExtensible=Object.isExtensible||returnIt;var reflect={apply:ctx(call,apply,3),construct:construct,defineProperty:wrap(defineProperty),deleteProperty:function(target,propertyKey){var desc=getOwnDescriptor(assertObject(target),propertyKey);return desc&&!desc.configurable?false:delete target[propertyKey]},enumerate:function(target){return new Enumerate(assertObject(target))},get:reflectGet,getOwnPropertyDescriptor:function(target,propertyKey){return getOwnDescriptor(assertObject(target),propertyKey)},getPrototypeOf:function(target){return getPrototypeOf(assertObject(target))},has:function(target,propertyKey){return propertyKey in target},isExtensible:function(target){return!!isExtensible(assertObject(target))},ownKeys:ownKeys,preventExtensions:wrap(Object.preventExtensions||returnIt),set:reflectSet};if(setPrototypeOf)reflect.setPrototypeOf=function(target,proto){return setPrototypeOf(assertObject(target),proto),true};$define(GLOBAL,{Reflect:{}});$define(STATIC,"Reflect",reflect)}();!function(){$define(PROTO,ARRAY,{includes:createArrayContains(true)});$define(PROTO,STRING,{at:createPointAt(true)});function createObjectToArray(isEntries){return function(object){var O=toObject(object),keys=getKeys(object),length=keys.length,i=0,result=Array(length),key;if(isEntries)while(length>i)result[i]=[key=keys[i++],O[key]];else while(length>i)result[i]=O[keys[i++]];return result}}$define(STATIC,OBJECT,{values:createObjectToArray(false),entries:createObjectToArray(true)});$define(STATIC,REGEXP,{escape:createReplacer(/([\\\-[\]{}()*+?.,^$|])/g,"\\$1",true)})}();!function(REFERENCE){REFERENCE_GET=getWellKnownSymbol(REFERENCE+"Get",true);var REFERENCE_SET=getWellKnownSymbol(REFERENCE+SET,true),REFERENCE_DELETE=getWellKnownSymbol(REFERENCE+"Delete",true);$define(STATIC,SYMBOL,{referenceGet:REFERENCE_GET,referenceSet:REFERENCE_SET,referenceDelete:REFERENCE_DELETE});hidden(FunctionProto,REFERENCE_GET,returnThis);function setMapMethods(Constructor){if(Constructor){var MapProto=Constructor[PROTOTYPE];hidden(MapProto,REFERENCE_GET,MapProto.get);hidden(MapProto,REFERENCE_SET,MapProto.set);hidden(MapProto,REFERENCE_DELETE,MapProto["delete"])}}setMapMethods(Map);setMapMethods(WeakMap)}("reference");!function(arrayStatics){function setArrayStatics(keys,length){forEach.call(array(keys),function(key){if(key in ArrayProto)arrayStatics[key]=ctx(call,ArrayProto[key],length)})}setArrayStatics("pop,reverse,shift,keys,values,entries",1);setArrayStatics("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3);setArrayStatics("join,slice,concat,push,splice,unshift,sort,lastIndexOf,"+"reduce,reduceRight,copyWithin,fill,turn");$define(STATIC,ARRAY,arrayStatics)}({});!function(NodeList){if(framework&&NodeList&&!(SYMBOL_ITERATOR in NodeList[PROTOTYPE])){hidden(NodeList[PROTOTYPE],SYMBOL_ITERATOR,Iterators[ARRAY])}Iterators.NodeList=Iterators[ARRAY]}(global.NodeList)}(typeof self!="undefined"&&self.Math===Math?self:Function("return this")(),true)},{}],57:[function(require,module,exports){(function(global){!function(global){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var undefined;var iteratorSymbol=typeof Symbol==="function"&&Symbol.iterator||"@@iterator";var inModule=typeof module==="object";var runtime=global.regeneratorRuntime;if(runtime){if(inModule){module.exports=runtime}return}runtime=global.regeneratorRuntime=inModule?module.exports:{};function wrap(innerFn,outerFn,self,tryLocsList){return new Generator(innerFn,outerFn,self||null,tryLocsList||[])}runtime.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype;GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunction.displayName="GeneratorFunction";runtime.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};runtime.mark=function(genFun){genFun.__proto__=GeneratorFunctionPrototype;genFun.prototype=Object.create(Gp);return genFun};runtime.async=function(innerFn,outerFn,self,tryLocsList){return new Promise(function(resolve,reject){var generator=wrap(innerFn,outerFn,self,tryLocsList);var callNext=step.bind(generator.next);var callThrow=step.bind(generator["throw"]);function step(arg){var record=tryCatch(this,null,arg);if(record.type==="throw"){reject(record.arg);return}var info=record.arg;if(info.done){resolve(info.value)}else{Promise.resolve(info.value).then(callNext,callThrow)}}callNext()})};function Generator(innerFn,outerFn,self,tryLocsList){var generator=outerFn?Object.create(outerFn.prototype):this;var context=new Context(tryLocsList);var state=GenStateSuspendedStart;function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){return doneResult()}while(true){var delegate=context.delegate;if(delegate){var record=tryCatch(delegate.iterator[method],delegate.iterator,arg);if(record.type==="throw"){context.delegate=null;method="throw";arg=record.arg;continue}method="next";arg=undefined;var info=record.arg;if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc}else{state=GenStateSuspendedYield;return info}context.delegate=null}if(method==="next"){if(state===GenStateSuspendedStart&&typeof arg!=="undefined"){throw new TypeError("attempt to send "+JSON.stringify(arg)+" to newborn generator")}if(state===GenStateSuspendedYield){context.sent=arg}else{delete context.sent}}else if(method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw arg}if(context.dispatchException(arg)){method="next";arg=undefined}}else if(method==="return"){context.abrupt("return",arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;var info={value:record.arg,done:context.done};if(record.arg===ContinueSentinel){if(context.delegate&&method==="next"){arg=undefined}}else{return info}}else if(record.type==="throw"){state=GenStateCompleted;if(method==="next"){context.dispatchException(record.arg)}else{arg=record.arg}}}}generator.next=invoke.bind(generator,"next");generator["throw"]=invoke.bind(generator,"throw");generator["return"]=invoke.bind(generator,"return");return generator}Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset()}runtime.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}runtime.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(){this.prev=0;this.next=0;this.sent=undefined;this.done=false;this.delegate=null;this.tryEntries.forEach(resetTryEntry);for(var tempIndex=0,tempName;hasOwn.call(this,tempName="t"+tempIndex)||tempIndex<20;++tempIndex){this[tempName]=null}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},_findFinallyEntry:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&(entry.finallyLoc===finallyLoc||this.prev<entry.finallyLoc)){return entry}}},abrupt:function(type,arg){var entry=this._findFinallyEntry();var record=entry?entry.completion:{};record.type=type;record.arg=arg;if(entry){this.next=entry.finallyLoc}else{this.complete(record)}return ContinueSentinel},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=record.arg;this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){var entry=this._findFinallyEntry(finallyLoc);return this.complete(entry.completion,entry.afterLoc)},"catch":function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};return ContinueSentinel}}}(typeof global==="object"?global:typeof window==="object"?window:this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],58:[function(require,module,exports){module.exports=require("./lib/babel/api/register/node")},{"./lib/babel/api/register/node":54}],59:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],60:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],61:[function(require,module,exports){(function(process,global){(function(){"use strict";function $$utils$$objectOrFunction(x){return typeof x==="function"||typeof x==="object"&&x!==null}function $$utils$$isFunction(x){return typeof x==="function"}function $$utils$$isMaybeThenable(x){return typeof x==="object"&&x!==null}var $$utils$$_isArray;if(!Array.isArray){$$utils$$_isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"}}else{$$utils$$_isArray=Array.isArray}var $$utils$$isArray=$$utils$$_isArray;var $$utils$$now=Date.now||function(){return(new Date).getTime()};function $$utils$$F(){}var $$utils$$o_create=Object.create||function(o){if(arguments.length>1){throw new Error("Second argument not supported")}if(typeof o!=="object"){throw new TypeError("Argument must be an object")}$$utils$$F.prototype=o;return new $$utils$$F};var $$asap$$len=0;var $$asap$$default=function asap(callback,arg){$$asap$$queue[$$asap$$len]=callback;$$asap$$queue[$$asap$$len+1]=arg;$$asap$$len+=2;if($$asap$$len===2){$$asap$$scheduleFlush()}};var $$asap$$browserGlobal=typeof window!=="undefined"?window:{};var $$asap$$BrowserMutationObserver=$$asap$$browserGlobal.MutationObserver||$$asap$$browserGlobal.WebKitMutationObserver;var $$asap$$isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function $$asap$$useNextTick(){return function(){process.nextTick($$asap$$flush)}}function $$asap$$useMutationObserver(){var iterations=0;var observer=new $$asap$$BrowserMutationObserver($$asap$$flush);var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function $$asap$$useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=$$asap$$flush;return function(){channel.port2.postMessage(0)}}function $$asap$$useSetTimeout(){return function(){setTimeout($$asap$$flush,1)}}var $$asap$$queue=new Array(1e3);function $$asap$$flush(){for(var i=0;i<$$asap$$len;i+=2){var callback=$$asap$$queue[i];var arg=$$asap$$queue[i+1];callback(arg);$$asap$$queue[i]=undefined;$$asap$$queue[i+1]=undefined}$$asap$$len=0}var $$asap$$scheduleFlush;if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]"){$$asap$$scheduleFlush=$$asap$$useNextTick()}else if($$asap$$BrowserMutationObserver){$$asap$$scheduleFlush=$$asap$$useMutationObserver()}else if($$asap$$isWorker){$$asap$$scheduleFlush=$$asap$$useMessageChannel()}else{$$asap$$scheduleFlush=$$asap$$useSetTimeout()}function $$$internal$$noop(){}var $$$internal$$PENDING=void 0;var $$$internal$$FULFILLED=1;var $$$internal$$REJECTED=2;var $$$internal$$GET_THEN_ERROR=new $$$internal$$ErrorObject;function $$$internal$$selfFullfillment(){return new TypeError("You cannot resolve a promise with itself")}function $$$internal$$cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function $$$internal$$getThen(promise){try{return promise.then}catch(error){$$$internal$$GET_THEN_ERROR.error=error;return $$$internal$$GET_THEN_ERROR}}function $$$internal$$tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function $$$internal$$handleForeignThenable(promise,thenable,then){$$asap$$default(function(promise){var sealed=false;var error=$$$internal$$tryThen(then,thenable,function(value){if(sealed){return}sealed=true;if(thenable!==value){$$$internal$$resolve(promise,value)}else{$$$internal$$fulfill(promise,value)}},function(reason){if(sealed){return}sealed=true;$$$internal$$reject(promise,reason)},"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;$$$internal$$reject(promise,error)}},promise)}function $$$internal$$handleOwnThenable(promise,thenable){if(thenable._state===$$$internal$$FULFILLED){$$$internal$$fulfill(promise,thenable._result)}else if(promise._state===$$$internal$$REJECTED){$$$internal$$reject(promise,thenable._result)}else{$$$internal$$subscribe(thenable,undefined,function(value){$$$internal$$resolve(promise,value)},function(reason){$$$internal$$reject(promise,reason)})}}function $$$internal$$handleMaybeThenable(promise,maybeThenable){if(maybeThenable.constructor===promise.constructor){$$$internal$$handleOwnThenable(promise,maybeThenable)}else{var then=$$$internal$$getThen(maybeThenable);if(then===$$$internal$$GET_THEN_ERROR){$$$internal$$reject(promise,$$$internal$$GET_THEN_ERROR.error)}else if(then===undefined){$$$internal$$fulfill(promise,maybeThenable)}else if($$utils$$isFunction(then)){$$$internal$$handleForeignThenable(promise,maybeThenable,then)}else{$$$internal$$fulfill(promise,maybeThenable)}}}function $$$internal$$resolve(promise,value){if(promise===value){$$$internal$$reject(promise,$$$internal$$selfFullfillment())}else if($$utils$$objectOrFunction(value)){$$$internal$$handleMaybeThenable(promise,value)}else{$$$internal$$fulfill(promise,value)}}function $$$internal$$publishRejection(promise){if(promise._onerror){promise._onerror(promise._result)}$$$internal$$publish(promise)}function $$$internal$$fulfill(promise,value){if(promise._state!==$$$internal$$PENDING){return}promise._result=value;promise._state=$$$internal$$FULFILLED;if(promise._subscribers.length===0){}else{$$asap$$default($$$internal$$publish,promise)}}function $$$internal$$reject(promise,reason){if(promise._state!==$$$internal$$PENDING){return}promise._state=$$$internal$$REJECTED;promise._result=reason;$$asap$$default($$$internal$$publishRejection,promise)}function $$$internal$$subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers;var length=subscribers.length;parent._onerror=null;subscribers[length]=child;subscribers[length+$$$internal$$FULFILLED]=onFulfillment;subscribers[length+$$$internal$$REJECTED]=onRejection;if(length===0&&parent._state){$$asap$$default($$$internal$$publish,parent)}}function $$$internal$$publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return}var child,callback,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){$$$internal$$invokeCallback(settled,child,callback,detail)}else{callback(detail)}}promise._subscribers.length=0}function $$$internal$$ErrorObject(){this.error=null}var $$$internal$$TRY_CATCH_ERROR=new $$$internal$$ErrorObject;function $$$internal$$tryCatch(callback,detail){try{return callback(detail)}catch(e){$$$internal$$TRY_CATCH_ERROR.error=e;return $$$internal$$TRY_CATCH_ERROR}}function $$$internal$$invokeCallback(settled,promise,callback,detail){var hasCallback=$$utils$$isFunction(callback),value,error,succeeded,failed;if(hasCallback){value=$$$internal$$tryCatch(callback,detail);if(value===$$$internal$$TRY_CATCH_ERROR){failed=true;error=value.error;value=null}else{succeeded=true}if(promise===value){$$$internal$$reject(promise,$$$internal$$cannotReturnOwn());return}}else{value=detail;succeeded=true}if(promise._state!==$$$internal$$PENDING){}else if(hasCallback&&succeeded){$$$internal$$resolve(promise,value)}else if(failed){$$$internal$$reject(promise,error)}else if(settled===$$$internal$$FULFILLED){$$$internal$$fulfill(promise,value)}else if(settled===$$$internal$$REJECTED){$$$internal$$reject(promise,value)}}function $$$internal$$initializePromise(promise,resolver){try{resolver(function resolvePromise(value){$$$internal$$resolve(promise,value)},function rejectPromise(reason){$$$internal$$reject(promise,reason)})}catch(e){$$$internal$$reject(promise,e)}}function $$$enumerator$$makeSettledResult(state,position,value){if(state===$$$internal$$FULFILLED){return{state:"fulfilled",value:value}}else{return{state:"rejected",reason:value}}}function $$$enumerator$$Enumerator(Constructor,input,abortOnReject,label){this._instanceConstructor=Constructor;this.promise=new Constructor($$$internal$$noop,label);this._abortOnReject=abortOnReject;if(this._validateInput(input)){this._input=input;this.length=input.length;this._remaining=input.length;this._init();if(this.length===0){$$$internal$$fulfill(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){$$$internal$$fulfill(this.promise,this._result)}}}else{$$$internal$$reject(this.promise,this._validationError())}}$$$enumerator$$Enumerator.prototype._validateInput=function(input){return $$utils$$isArray(input)};$$$enumerator$$Enumerator.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};$$$enumerator$$Enumerator.prototype._init=function(){this._result=new Array(this.length)};var $$$enumerator$$default=$$$enumerator$$Enumerator;$$$enumerator$$Enumerator.prototype._enumerate=function(){var length=this.length;var promise=this.promise;var input=this._input;for(var i=0;promise._state===$$$internal$$PENDING&&i<length;i++){this._eachEntry(input[i],i)}};$$$enumerator$$Enumerator.prototype._eachEntry=function(entry,i){var c=this._instanceConstructor;if($$utils$$isMaybeThenable(entry)){if(entry.constructor===c&&entry._state!==$$$internal$$PENDING){entry._onerror=null;this._settledAt(entry._state,i,entry._result)}else{this._willSettleAt(c.resolve(entry),i)}}else{this._remaining--;this._result[i]=this._makeResult($$$internal$$FULFILLED,i,entry)}};$$$enumerator$$Enumerator.prototype._settledAt=function(state,i,value){var promise=this.promise;if(promise._state===$$$internal$$PENDING){this._remaining--;if(this._abortOnReject&&state===$$$internal$$REJECTED){$$$internal$$reject(promise,value)}else{this._result[i]=this._makeResult(state,i,value)}}if(this._remaining===0){$$$internal$$fulfill(promise,this._result)}};$$$enumerator$$Enumerator.prototype._makeResult=function(state,i,value){return value};$$$enumerator$$Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;$$$internal$$subscribe(promise,undefined,function(value){enumerator._settledAt($$$internal$$FULFILLED,i,value)},function(reason){enumerator._settledAt($$$internal$$REJECTED,i,reason)})};var $$promise$all$$default=function all(entries,label){return new $$$enumerator$$default(this,entries,true,label).promise};var $$promise$race$$default=function race(entries,label){var Constructor=this;var promise=new Constructor($$$internal$$noop,label);if(!$$utils$$isArray(entries)){$$$internal$$reject(promise,new TypeError("You must pass an array to race."));return promise}var length=entries.length;function onFulfillment(value){$$$internal$$resolve(promise,value)}function onRejection(reason){$$$internal$$reject(promise,reason)}for(var i=0;promise._state===$$$internal$$PENDING&&i<length;i++){$$$internal$$subscribe(Constructor.resolve(entries[i]),undefined,onFulfillment,onRejection)}return promise};var $$promise$resolve$$default=function resolve(object,label){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===Constructor){return object}var promise=new Constructor($$$internal$$noop,label);$$$internal$$resolve(promise,object);return promise};var $$promise$reject$$default=function reject(reason,label){var Constructor=this;var promise=new Constructor($$$internal$$noop,label);$$$internal$$reject(promise,reason);return promise};var $$es6$promise$promise$$counter=0;function $$es6$promise$promise$$needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function $$es6$promise$promise$$needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var $$es6$promise$promise$$default=$$es6$promise$promise$$Promise;function $$es6$promise$promise$$Promise(resolver){this._id=$$es6$promise$promise$$counter++;this._state=undefined;this._result=undefined;this._subscribers=[];
if($$$internal$$noop!==resolver){if(!$$utils$$isFunction(resolver)){$$es6$promise$promise$$needsResolver()}if(!(this instanceof $$es6$promise$promise$$Promise)){$$es6$promise$promise$$needsNew()}$$$internal$$initializePromise(this,resolver)}}$$es6$promise$promise$$Promise.all=$$promise$all$$default;$$es6$promise$promise$$Promise.race=$$promise$race$$default;$$es6$promise$promise$$Promise.resolve=$$promise$resolve$$default;$$es6$promise$promise$$Promise.reject=$$promise$reject$$default;$$es6$promise$promise$$Promise.prototype={constructor:$$es6$promise$promise$$Promise,then:function(onFulfillment,onRejection){var parent=this;var state=parent._state;if(state===$$$internal$$FULFILLED&&!onFulfillment||state===$$$internal$$REJECTED&&!onRejection){return this}var child=new this.constructor($$$internal$$noop);var result=parent._result;if(state){var callback=arguments[state-1];$$asap$$default(function(){$$$internal$$invokeCallback(state,child,callback,result)})}else{$$$internal$$subscribe(parent,child,onFulfillment,onRejection)}return child},"catch":function(onRejection){return this.then(null,onRejection)}};var $$es6$promise$polyfill$$default=function polyfill(){var local;if(typeof global!=="undefined"){local=global}else if(typeof window!=="undefined"&&window.document){local=window}else{local=self}var es6PromiseSupport="Promise"in local&&"resolve"in local.Promise&&"reject"in local.Promise&&"all"in local.Promise&&"race"in local.Promise&&function(){var resolve;new local.Promise(function(r){resolve=r});return $$utils$$isFunction(resolve)}();if(!es6PromiseSupport){local.Promise=$$es6$promise$promise$$default}};var es6$promise$umd$$ES6Promise={Promise:$$es6$promise$promise$$default,polyfill:$$es6$promise$polyfill$$default};if(typeof define==="function"&&define["amd"]){define(function(){return es6$promise$umd$$ES6Promise})}else if(typeof module!=="undefined"&&module["exports"]){module["exports"]=es6$promise$umd$$ES6Promise}else if(typeof this!=="undefined"){this["ES6Promise"]=es6$promise$umd$$ES6Promise}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:60}],62:[function(require,module,exports){module.exports.Dispatcher=require("./lib/Dispatcher")},{"./lib/Dispatcher":63}],63:[function(require,module,exports){"use strict";var invariant=require("./invariant");var _lastID=1;var _prefix="ID_";function Dispatcher(){this.$Dispatcher_callbacks={};this.$Dispatcher_isPending={};this.$Dispatcher_isHandled={};this.$Dispatcher_isDispatching=false;this.$Dispatcher_pendingPayload=null}Dispatcher.prototype.register=function(callback){var id=_prefix+_lastID++;this.$Dispatcher_callbacks[id]=callback;return id};Dispatcher.prototype.unregister=function(id){invariant(this.$Dispatcher_callbacks[id],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",id);delete this.$Dispatcher_callbacks[id]};Dispatcher.prototype.waitFor=function(ids){invariant(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var ii=0;ii<ids.length;ii++){var id=ids[ii];if(this.$Dispatcher_isPending[id]){invariant(this.$Dispatcher_isHandled[id],"Dispatcher.waitFor(...): Circular dependency detected while "+"waiting for `%s`.",id);continue}invariant(this.$Dispatcher_callbacks[id],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",id);this.$Dispatcher_invokeCallback(id)}};Dispatcher.prototype.dispatch=function(payload){invariant(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch.");this.$Dispatcher_startDispatching(payload);try{for(var id in this.$Dispatcher_callbacks){if(this.$Dispatcher_isPending[id]){continue}this.$Dispatcher_invokeCallback(id)}}finally{this.$Dispatcher_stopDispatching()}};Dispatcher.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching};Dispatcher.prototype.$Dispatcher_invokeCallback=function(id){this.$Dispatcher_isPending[id]=true;this.$Dispatcher_callbacks[id](this.$Dispatcher_pendingPayload);this.$Dispatcher_isHandled[id]=true};Dispatcher.prototype.$Dispatcher_startDispatching=function(payload){for(var id in this.$Dispatcher_callbacks){this.$Dispatcher_isPending[id]=false;this.$Dispatcher_isHandled[id]=false}this.$Dispatcher_pendingPayload=payload;this.$Dispatcher_isDispatching=true};Dispatcher.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null;this.$Dispatcher_isDispatching=false};module.exports=Dispatcher},{"./invariant":64}],64:[function(require,module,exports){"use strict";var invariant=function(condition,format,a,b,c,d,e,f){if(false){if(format===undefined){throw new Error("invariant requires an error message argument")}}if(!condition){var error;if(format===undefined){error=new Error("Minified exception occurred; use the non-minified dev environment "+"for the full error message and additional helpful warnings.")}else{var args=[a,b,c,d,e,f];var argIndex=0;error=new Error("Invariant Violation: "+format.replace(/%s/g,function(){return args[argIndex++]}))}error.framesToPop=1;throw error}};module.exports=invariant},{}],65:[function(require,module,exports){(function(){"use strict";if(self.fetch){return}function Headers(headers){this.map={};var self=this;if(headers instanceof Headers){headers.forEach(function(name,values){values.forEach(function(value){self.append(name,value)})})}else if(headers){Object.getOwnPropertyNames(headers).forEach(function(name){self.append(name,headers[name])})}}Headers.prototype.append=function(name,value){name=name.toLowerCase();var list=this.map[name];if(!list){list=[];this.map[name]=list}list.push(value)};Headers.prototype["delete"]=function(name){delete this.map[name.toLowerCase()]};Headers.prototype.get=function(name){var values=this.map[name.toLowerCase()];return values?values[0]:null};Headers.prototype.getAll=function(name){return this.map[name.toLowerCase()]||[]};Headers.prototype.has=function(name){return this.map.hasOwnProperty(name.toLowerCase())};Headers.prototype.set=function(name,value){this.map[name.toLowerCase()]=[value]};Headers.prototype.forEach=function(callback){var self=this;Object.getOwnPropertyNames(this.map).forEach(function(name){callback(name,self.map[name])})};function consumed(body){if(body.bodyUsed){return Promise.reject(new TypeError("Already read"))}body.bodyUsed=true}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)};reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader;reader.readAsArrayBuffer(blob);return fileReaderReady(reader)}function readBlobAsText(blob){var reader=new FileReader;reader.readAsText(blob);return fileReaderReady(reader)}var support={blob:"FileReader"in self&&"Blob"in self&&function(){try{new Blob;return true}catch(e){return false}}(),formData:"FormData"in self};function Body(){this.bodyUsed=false;if(support.blob){this._initBody=function(body){this._bodyInit=body;if(typeof body==="string"){this._bodyText=body}else if(support.blob&&Blob.prototype.isPrototypeOf(body)){this._bodyBlob=body}else if(support.formData&&FormData.prototype.isPrototypeOf(body)){this._bodyFormData=body}else if(!body){this._bodyText=""}else{throw new Error("unsupported BodyInit type")}};this.blob=function(){var rejected=consumed(this);if(rejected){return rejected}if(this._bodyBlob){return Promise.resolve(this._bodyBlob)}else if(this._bodyFormData){throw new Error("could not read FormData body as blob")}else{return Promise.resolve(new Blob([this._bodyText]))}};this.arrayBuffer=function(){return this.blob().then(readBlobAsArrayBuffer)};this.text=function(){var rejected=consumed(this);if(rejected){return rejected}if(this._bodyBlob){return readBlobAsText(this._bodyBlob)}else if(this._bodyFormData){throw new Error("could not read FormData body as text")}else{return Promise.resolve(this._bodyText)}}}else{this._initBody=function(body){this._bodyInit=body;if(typeof body==="string"){this._bodyText=body}else if(support.formData&&FormData.prototype.isPrototypeOf(body)){this._bodyFormData=body}else if(!body){this._bodyText=""}else{throw new Error("unsupported BodyInit type")}};this.text=function(){var rejected=consumed(this);return rejected?rejected:Promise.resolve(this._bodyText)}}if(support.formData){this.formData=function(){return this.text().then(decode)}}this.json=function(){return this.text().then(JSON.parse)};return this}var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}function Request(url,options){options=options||{};this.url=url;this.credentials=options.credentials||"omit";this.headers=new Headers(options.headers);this.method=normalizeMethod(options.method||"GET");this.mode=options.mode||null;this.referrer=null;if((this.method==="GET"||this.method==="HEAD")&&options.body){throw new TypeError("Body not allowed for GET or HEAD requests")}this._initBody(options.body)}function decode(body){var form=new FormData;body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("=");var name=split.shift().replace(/\+/g," ");var value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}});return form}function headers(xhr){var head=new Headers;var pairs=xhr.getAllResponseHeaders().trim().split("\n");pairs.forEach(function(header){var split=header.trim().split(":");var key=split.shift().trim();var value=split.join(":").trim();head.append(key,value)});return head}Request.prototype.fetch=function(){var self=this;return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;if(self.credentials==="cors"){xhr.withCredentials=true}function responseURL(){if("responseURL"in xhr){return xhr.responseURL}if(/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())){return xhr.getResponseHeader("X-Request-URL")}return}xhr.onload=function(){var status=xhr.status===1223?204:xhr.status;if(status<100||status>599){reject(new TypeError("Network request failed"));return}var options={status:status,statusText:xhr.statusText,headers:headers(xhr),url:responseURL()};var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))};xhr.onerror=function(){reject(new TypeError("Network request failed"))};xhr.open(self.method,self.url,true);if("responseType"in xhr&&support.blob){xhr.responseType="blob"}self.headers.forEach(function(name,values){values.forEach(function(value){xhr.setRequestHeader(name,value)})});xhr.send(typeof self._bodyInit==="undefined"?null:self._bodyInit)})};Body.call(Request.prototype);function Response(bodyInit,options){if(!options){options={}}this._initBody(bodyInit);this.type="default";this.url=null;this.status=options.status;this.statusText=options.statusText;this.headers=options.headers;this.url=options.url||""}Body.call(Response.prototype);self.Headers=Headers;self.Request=Request;self.Response=Response;self.fetch=function(url,options){return new Request(url,options).fetch()};self.fetch.polyfill=true})()},{}],66:[function(require,module,exports){require("whatwg-fetch")},{"whatwg-fetch":65}],67:[function(require,module,exports){(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.8.1";var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};var cb=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value))return _.matcher(value);return _.property(value)};_.iteratee=function(value,context){return cb(value,context,Infinity)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!undefinedOnly||obj[key]===void 0)obj[key]=source[key]}}return obj}};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var isArrayLike=function(collection){var length=collection&&collection.length;return typeof length=="number"&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj)}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj)}}return obj};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir}return iterator(obj,iteratee,memo,keys,index,length)}}_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var key;if(isArrayLike(obj)){key=_.findIndex(obj,predicate,context)}else{key=_.findKey(obj,predicate,context)}if(key!==void 0&&key!==-1)return obj[key]};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.includes=_.include=function(obj,target){if(!isArrayLike(obj))obj=_.values(obj);return _.indexOf(obj,target)>=0};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return func==null?func:func.apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed}})}return result};_.shuffle=function(obj){var set=isArrayLike(obj)?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index]}return shuffled};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length};_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];return _.initial(array,array.length-n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){var output=[],idx=0;for(var i=startIndex||0,length=input&&input.length;i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(!shallow)value=flatten(value,shallow,strict);var j=0,len=value.length;output.length+=len;while(j<len){output[idx++]=value[j++]}}else if(!strict){output[idx++]=value}}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false)};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(array==null)return[];if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=array.length;i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed)result.push(value);seen=computed}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value)}}else if(!_.contains(result,value)){result.push(value)}}return result};_.union=function(){return _.uniq(flatten(arguments,true,true))};_.intersection=function(array){if(array==null)return[];var result=[];var argsLength=arguments.length;for(var i=0,length=array.length;i<length;i++){var item=array[i];if(_.contains(result,item))continue;for(var j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break}if(j===argsLength)result.push(item)}return result};_.difference=function(array){var rest=flatten(arguments,true,true,1);return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){return _.unzip(arguments)};_.unzip=function(array){var length=array&&_.max(array,"length").length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index)}return result};_.object=function(list,values){var result={};for(var i=0,length=list&&list.length;i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){var i=0,length=array&&array.length;if(typeof isSorted=="number"){i=isSorted<0?Math.max(0,length+isSorted):isSorted}else if(isSorted&&length){i=_.sortedIndex(array,item);return array[i]===item?i:-1}if(item!==item){return _.findIndex(slice.call(array,i),_.isNaN)}for(;i<length;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){var idx=array?array.length:0;if(typeof from=="number"){idx=from<0?idx+from+1:Math.min(idx,from+1)}if(item!==item){return _.findLastIndex(slice.call(array,0,idx),_.isNaN)}while(--idx>=0)if(array[idx]===item)return idx;return-1};function createIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=array!=null&&array.length;var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index}return-1}}_.findIndex=createIndexFinder(1);_.findLastIndex=createIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=array.length;while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2);var bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound};_.partial=function(func){var boundArgs=slice.call(arguments,1);var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i]}while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj)}return obj};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=""+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>=0){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);context=args=null}return result}};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments)}if(times<=1)func=null;return memo}};_.once=_.partial(_.before,2);_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={},currentKey;for(var index=0;index<length;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=createAssigner(_.allKeys);_.extendOwn=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};_.pick=function(obj,iteratee,context){var result={},key;if(obj==null)return result;if(_.isFunction(iteratee)){iteratee=optimizeCb(iteratee,context);var keys=_.allKeys(obj);for(var i=0;i<keys.length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value}}else{var keys=flatten(arguments,false,false,1);obj=new Object(obj);for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(key in obj)result[key]=obj[key]}}return result};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee)){iteratee=_.negate(iteratee)}else{var keys=_.map(flatten(arguments,false,false,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)};_.defaults=createAssigner(_.allKeys,true);_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false}return true};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays=className==="[object Array]";if(!areArrays){if(typeof a!="object"||typeof b!="object")return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&("constructor"in a&&"constructor"in b)){return false}}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b}aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false}}aStack.pop();bStack.pop();return true};_.isEqual=function(a,b){return eq(a,b)};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,"callee")}}if(typeof/./!="function"&&typeof Int8Array!="object"){_.isFunction=function(obj){return typeof obj=="function"||false}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=function(key){return function(obj){return obj==null?void 0:obj[key]}};_.propertyOf=function(obj){return obj==null?function(){}:function(key){return obj[key]}};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);
return function(obj){return _.isMatch(obj,attrs)}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property,fallback){var value=object==null?void 0:object[property];if(value===void 0){value=fallback}return _.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}else if(evaluate){source+="';\n"+evaluate+"\n__p+='"}return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(_,args))}})};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return result(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return""+this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return _})}}).call(this)},{}]},{},[])("./index.js")});